!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).bundle=e()}}(function(){return function i(a,u,s){function c(t,e){if(!u[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[t]={exports:{}};a[t][0].call(o.exports,function(e){return c(a[t][1][e]||e)},o,o.exports,i,a,u,s)}return u[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){var r=function(e){var c="b",l="w",s=-1,y="p",w="n",k="b",P="r",x="q",f="k",r="pnbrqkPNBRQK",t="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",p=["1-0","0-1","1/2-1/2","*"],C={b:[16,32,17,15],w:[-16,-32,-17,-15]},E={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},d=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],v=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],h={p:0,n:1,b:2,r:3,q:4,k:5},o={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},_={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},A=7,O=6,N=1,S=0,M={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m={w:[{square:M.a1,flag:_.QSIDE_CASTLE},{square:M.h1,flag:_.KSIDE_CASTLE}],b:[{square:M.a8,flag:_.QSIDE_CASTLE},{square:M.h8,flag:_.KSIDE_CASTLE}]},R=new Array(128),T={w:s,b:s},K=l,I={w:0,b:0},L=s,g=0,b=1,j=[],B={};function u(){R=new Array(128),T={w:s,b:s},K=l,I={w:0,b:0},L=s,g=0,b=1,j=[],B={},W(U())}function D(){q(t)}function q(e){var t=e.split(/\s+/),n=t[0],r=0;if(!Q(e).valid)return!1;u();for(var o=0;o<n.length;o++){var i=n.charAt(o);if("/"===i)r+=8;else if(-1!=="0123456789".indexOf(i))r+=parseInt(i,10);else{var a=i<"a"?l:c;F({type:i.toLowerCase(),color:a},ae(r)),r++}}return K=t[1],-1<t[2].indexOf("K")&&(I.w|=_.KSIDE_CASTLE),-1<t[2].indexOf("Q")&&(I.w|=_.QSIDE_CASTLE),-1<t[2].indexOf("k")&&(I.b|=_.KSIDE_CASTLE),-1<t[2].indexOf("q")&&(I.b|=_.QSIDE_CASTLE),L="-"===t[3]?s:M[t[3]],g=parseInt(t[4],10),b=parseInt(t[5],10),W(U()),!0}function Q(e){var t="No errors.",n="FEN string must contain six space-delimited fields.",r="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",u="2nd field (side to move) is invalid.",s="1st field (piece positions) does not contain 8 '/'-delimited rows.",c="1st field (piece positions) is invalid [consecutive numbers].",l="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",d="Illegal en-passant square",v=e.split(/\s+/);if(6!==v.length)return{valid:!1,error_number:1,error:n};if(isNaN(v[5])||parseInt(v[5],10)<=0)return{valid:!1,error_number:2,error:r};if(isNaN(v[4])||parseInt(v[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(v[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(v[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(v[1]))return{valid:!1,error_number:6,error:u};var p=v[0].split("/");if(8!==p.length)return{valid:!1,error_number:7,error:s};for(var h=0;h<p.length;h++){for(var m=0,g=!1,b=0;b<p[h].length;b++)if(isNaN(p[h][b])){if(!/^[prnbqkPRNBQK]$/.test(p[h][b]))return{valid:!1,error_number:9,error:l};m+=1,g=!1}else{if(g)return{valid:!1,error_number:8,error:c};m+=parseInt(p[h][b],10),g=!0}if(8!==m)return{valid:!1,error_number:10,error:f}}return"3"==v[3][1]&&"w"==v[1]||"6"==v[3][1]&&"b"==v[1]?{valid:!1,error_number:11,error:d}:{valid:!0,error_number:0,error:t}}function U(){for(var e=0,t="",n=M.a8;n<=M.h1;n++){if(null==R[n])e++;else{0<e&&(t+=e,e=0);var r=R[n].color,o=R[n].type;t+=r===l?o.toUpperCase():o.toLowerCase()}n+1&136&&(0<e&&(t+=e),n!==M.h1&&(t+="/"),e=0,n+=8)}var i="";I[l]&_.KSIDE_CASTLE&&(i+="K"),I[l]&_.QSIDE_CASTLE&&(i+="Q"),I[c]&_.KSIDE_CASTLE&&(i+="k"),I[c]&_.QSIDE_CASTLE&&(i+="q"),i=i||"-";var a=L===s?"-":ae(L);return[t,K,i,a,g,b].join(" ")}function z(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(B[e[t]]=e[t+1]);return B}function W(e){0<j.length||(e!==t?(B.SetUp="1",B.FEN=e):(delete B.SetUp,delete B.FEN))}function i(e){var t=R[M[e]];return t?{type:t.type,color:t.color}:null}function F(e,t){if(!("type"in e&&"color"in e))return!1;if(-1===r.indexOf(e.type.toLowerCase()))return!1;if(!(t in M))return!1;var n=M[t];return(e.type!=f||T[e.color]==s||T[e.color]==n)&&(R[n]={type:e.type,color:e.color},e.type===f&&(T[e.color]=n),W(U()),!0)}function H(e,t,n,r,o){var i={color:K,from:t,to:n,flags:r,piece:e[t].type};return o&&(i.flags|=_.PROMOTION,i.promotion=o),e[n]?i.captured=e[n].type:r&_.EP_CAPTURE&&(i.captured=y),i}function $(e){function t(e,t,n,r,o){if(e[n].type!==y||oe(r)!==S&&oe(r)!==A)t.push(H(e,n,r,o));else for(var i=[x,P,k,w],a=0,u=i.length;a<u;a++)t.push(H(e,n,r,o,i[a]))}var n=[],r=K,o=ue(r),i={b:N,w:O},a=M.a8,u=M.h1,s=!1,c=!(void 0!==e&&"legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in M))return[];a=u=M[e.square],s=!0}for(var l=a;l<=u;l++)if(136&l)l+=7;else{var f=R[l];if(null!=f&&f.color===r)if(f.type===y){var d=l+C[r][0];if(null==R[d]){t(R,n,l,d,_.NORMAL);d=l+C[r][1];i[r]===oe(l)&&null==R[d]&&t(R,n,l,d,_.BIG_PAWN)}for(v=2;v<4;v++){136&(d=l+C[r][v])||(null!=R[d]&&R[d].color===o?t(R,n,l,d,_.CAPTURE):d===L&&t(R,n,l,L,_.EP_CAPTURE))}}else for(var v=0,p=E[f.type].length;v<p;v++){var h=E[f.type][v];for(d=l;!(136&(d+=h));){if(null!=R[d]){if(R[d].color===r)break;t(R,n,l,d,_.CAPTURE);break}if(t(R,n,l,d,_.NORMAL),"n"===f.type||"k"===f.type)break}}}if(!s||u===T[r]){if(I[r]&_.KSIDE_CASTLE){var m=(g=T[r])+2;null!=R[g+1]||null!=R[m]||Z(o,T[r])||Z(o,g+1)||Z(o,m)||t(R,n,T[r],m,_.KSIDE_CASTLE)}if(I[r]&_.QSIDE_CASTLE){var g;m=(g=T[r])-2;null!=R[g-1]||null!=R[g-2]||null!=R[g-3]||Z(o,T[r])||Z(o,g-1)||Z(o,m)||t(R,n,T[r],m,_.QSIDE_CASTLE)}}if(!c)return n;var b=[];for(l=0,p=n.length;l<p;l++)te(n[l]),V(r)||b.push(n[l]),ne();return b}function X(e,t){var n="";if(e.flags&_.KSIDE_CASTLE)n="O-O";else if(e.flags&_.QSIDE_CASTLE)n="O-O-O";else{var r=function(e,t){for(var n=$({legal:!t}),r=e.from,o=e.to,i=e.piece,a=0,u=0,s=0,c=0,l=n.length;c<l;c++){var f=n[c].from,d=n[c].to,v=n[c].piece;i===v&&r!==f&&o===d&&(a++,oe(r)===oe(f)&&u++,ie(r)===ie(f)&&s++)}if(0<a)return 0<u&&0<s?ae(r):0<s?ae(r).charAt(1):ae(r).charAt(0);return""}(e,t);e.piece!==y&&(n+=e.piece.toUpperCase()+r),e.flags&(_.CAPTURE|_.EP_CAPTURE)&&(e.piece===y&&(n+=ae(e.from)[0]),n+="x"),n+=ae(e.to),e.flags&_.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return te(e),a()&&(Y()?n+="#":n+="+"),ne(),n}function G(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Z(e,t){for(var n=M.a8;n<=M.h1;n++)if(136&n)n+=7;else if(null!=R[n]&&R[n].color===e){var r=R[n],o=n-t,i=o+119;if(d[i]&1<<h[r.type]){if(r.type===y){if(0<o){if(r.color===l)return!0}else if(r.color===c)return!0;continue}if("n"===r.type||"k"===r.type)return!0;for(var a=v[i],u=n+a,s=!1;u!==t;){if(null!=R[u]){s=!0;break}u+=a}if(!s)return!0}}return!1}function V(e){return Z(ue(e),T[e])}function a(){return V(K)}function Y(){return a()&&0===$().length}function n(){return!a()&&0===$().length}function J(){for(var e={},t=[],n=0,r=0,o=M.a8;o<=M.h1;o++)if(r=(r+1)%2,136&o)o+=7;else{var i=R[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===k&&t.push(r),n++)}if(2===n)return!0;if(3===n&&(1===e[k]||1===e[w]))return!0;if(n===e[k]+2){var a=0,u=t.length;for(o=0;o<u;o++)a+=t[o];if(0===a||a===u)return!0}return!1}function ee(){for(var e=[],t={},n=!1;;){var r=ne();if(!r)break;e.push(r)}for(;;){var o=U().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,3<=t[o]&&(n=!0),!e.length)break;te(e.pop())}return n}function te(e){var t,n=K,r=ue(n);if(t=e,j.push({move:t,kings:{b:T.b,w:T.w},turn:K,castling:{b:I.b,w:I.w},ep_square:L,half_moves:g,move_number:b}),R[e.to]=R[e.from],R[e.from]=null,e.flags&_.EP_CAPTURE&&(K===c?R[e.to-16]=null:R[e.to+16]=null),e.flags&_.PROMOTION&&(R[e.to]={type:e.promotion,color:n}),R[e.to].type===f){if(T[R[e.to].color]=e.to,e.flags&_.KSIDE_CASTLE){var o=e.to-1,i=e.to+1;R[o]=R[i],R[i]=null}else if(e.flags&_.QSIDE_CASTLE){o=e.to+1,i=e.to-2;R[o]=R[i],R[i]=null}I[n]=""}if(I[n])for(var a=0,u=m[n].length;a<u;a++)if(e.from===m[n][a].square&&I[n]&m[n][a].flag){I[n]^=m[n][a].flag;break}if(I[r])for(a=0,u=m[r].length;a<u;a++)if(e.to===m[r][a].square&&I[r]&m[r][a].flag){I[r]^=m[r][a].flag;break}L=e.flags&_.BIG_PAWN?"b"===K?e.to-16:e.to+16:s,e.piece===y?g=0:e.flags&(_.CAPTURE|_.EP_CAPTURE)?g=0:g++,K===c&&b++,K=ue(K)}function ne(){var e=j.pop();if(null==e)return null;var t=e.move;T=e.kings,K=e.turn,I=e.castling,L=e.ep_square,g=e.half_moves,b=e.move_number;var n,r,o=K,i=ue(K);if(R[t.from]=R[t.to],R[t.from].type=t.piece,R[t.to]=null,t.flags&_.CAPTURE)R[t.to]={type:t.captured,color:i};else if(t.flags&_.EP_CAPTURE){var a;a=o===c?t.to-16:t.to+16,R[a]={type:y,color:i}}t.flags&(_.KSIDE_CASTLE|_.QSIDE_CASTLE)&&(t.flags&_.KSIDE_CASTLE?(n=t.to+1,r=t.to-1):t.flags&_.QSIDE_CASTLE&&(n=t.to-2,r=t.to+1),R[n]=R[r],R[r]=null);return t}function re(e,t){var n=G(e);if(t){var r=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(r)var o=r[1],i=r[2],a=r[3],u=r[4]}for(var s=$(),c=0,l=s.length;c<l;c++){if(n===G(X(s[c]))||t&&n===G(X(s[c],!0)))return s[c];if(r&&(!o||o.toLowerCase()==s[c].piece)&&M[i]==s[c].from&&M[a]==s[c].to&&(!u||u.toLowerCase()==s[c].promotion))return s[c]}return null}function oe(e){return e>>4}function ie(e){return 15&e}function ae(e){var t=ie(e),n=oe(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function ue(e){return e===l?c:l}function se(e){var t=function e(t){var n=t instanceof Array?[]:{};for(var r in t)n[r]="object"==typeof r?e(t[r]):t[r];return n}(e);t.san=X(t,!1),t.to=ae(t.to),t.from=ae(t.from);var n="";for(var r in _)_[r]&t.flags&&(n+=o[r]);return t.flags=n,t}function ce(e){return e.replace(/^\s+|\s+$/g,"")}return q(void 0===e?t:e),{WHITE:l,BLACK:c,PAWN:y,KNIGHT:w,BISHOP:k,ROOK:P,QUEEN:x,KING:f,SQUARES:function(){for(var e=[],t=M.a8;t<=M.h1;t++)136&t?t+=7:e.push(ae(t));return e}(),FLAGS:o,load:function(e){return q(e)},reset:function(){return D()},moves:function(e){for(var t=$(e),n=[],r=0,o=t.length;r<o;r++)void 0!==e&&"verbose"in e&&e.verbose?n.push(se(t[r])):n.push(X(t[r],!1));return n},in_check:function(){return a()},in_checkmate:function(){return Y()},in_stalemate:function(){return n()},in_draw:function(){return 100<=g||n()||J()||ee()},insufficient_material:function(){return J()},in_threefold_repetition:function(){return ee()},game_over:function(){return 100<=g||Y()||n()||J()||ee()},validate_fen:function(e){return Q(e)},fen:function(){return U()},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,r=[],o=!1;for(var i in B)r.push("["+i+' "'+B[i]+'"]'+t),o=!0;o&&j.length&&r.push(t);for(var a=[];0<j.length;)a.push(ne());for(var u=[],s="";0<a.length;){var c=a.pop();j.length||"b"!==c.color?"w"===c.color&&(s.length&&u.push(s),s=b+"."):s=b+". ...",s=s+" "+X(c,!1),te(c)}if(s.length&&u.push(s),void 0!==B.Result&&u.push(B.Result),0===n)return r.join("")+u.join(" ");var l=0;for(i=0;i<u.length;i++)l+u[i].length>n&&0!==i?(" "===r[r.length-1]&&r.pop(),r.push(t),l=0):0!==i&&(r.push(" "),l++),r.push(u[i]),l+=u[i].length;return r.join("")},load_pgn:function(e,t){var n=void 0!==t&&"sloppy"in t&&t.sloppy;function s(e){return e.replace(/\\/g,"\\")}var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",o=new RegExp("^(\\[(.|"+s(r)+")*\\])("+s(r)+")*1.("+s(r)+"|.)*$","g"),i=e.replace(o,"$1");"["!==i[0]&&(i=""),D();var a=function(e,t){for(var n="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",r={},o=e.split(new RegExp(s(n))),i="",a="",u=0;u<o.length;u++)i=o[u].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),a=o[u].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),0<ce(i).length&&(r[i]=a);return r}(i,t);for(var u in a)z([u,a[u]]);if("1"===a.SetUp&&!("FEN"in a&&q(a.FEN)))return!1;var c=e.replace(i,"").replace(new RegExp(s(r),"g")," ");c=c.replace(/(\{[^}]+\})+?/g,"");for(var l=/(\([^\(\)]+\))+?/g;l.test(c);)c=c.replace(l,"");var f=ce(c=(c=(c=c.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));f=f.join(",").replace(/,,+/g,",").split(",");for(var d="",v=0;v<f.length-1;v++){if(null==(d=re(f[v],n)))return!1;te(d)}if(d=f[f.length-1],-1<p.indexOf(d))(function(e){for(var t in e)return!0;return!1})(B)&&void 0===B.Result&&z(["Result",d]);else{if(null==(d=re(d,n)))return!1;te(d)}return!0},header:function(){return z(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",t=M.a8;t<=M.h1;t++){if(0===ie(t)&&(e+=" "+"87654321"[oe(t)]+" |"),null==R[t])e+=" . ";else{var n=R[t].type;e+=" "+(R[t].color===l?n.toUpperCase():n.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return K},move:function(e,t){var n=void 0!==t&&"sloppy"in t&&t.sloppy,r=null;if("string"==typeof e)r=re(e,n);else if("object"==typeof e)for(var o=$(),i=0,a=o.length;i<a;i++)if(!(e.from!==ae(o[i].from)||e.to!==ae(o[i].to)||"promotion"in o[i]&&e.promotion!==o[i].promotion)){r=o[i];break}if(!r)return null;var u=se(r);return te(r),u},undo:function(){var e=ne();return e?se(e):null},clear:function(){return u()},put:function(e,t){return F(e,t)},get:function(e){return i(e)},remove:function(e){return n=i(t=e),R[M[t]]=null,n&&n.type===f&&(T[n.color]=s),W(U()),n;var t,n},perft:function(e){return function e(t){for(var n=$({legal:!1}),r=0,o=K,i=0,a=n.length;i<a;i++)te(n[i]),V(o)||(0<t-1?r+=e(t-1):r++),ne();return r}(e)},square_color:function(e){if(e in M){var t=M[e];return(oe(t)+ie(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],n=[],r=(void 0!==e&&"verbose"in e&&e.verbose);0<j.length;)t.push(ne());for(;0<t.length;){var o=t.pop();r?n.push(se(o)):n.push(X(o)),te(o)}return n}}};void 0!==n&&(n.Chess=r)},{}],2:[function(e,t,n){"use strict";var a=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(n,"__esModule",{value:!0});var h=e("./util");function r(e,t){var n=e(t);return t.dom.redraw(),n}function m(e,t){return{key:e,pos:h.key2pos(e),piece:t}}n.anim=function(e,t){return t.animation.enabled?function(e,t){var n=a({},t.pieces),r=e(t),o=function(e,t){var n,r,o,i,a={},u=[],s={},c=[],l=[],f={};for(o in e)f[o]=m(o,e[o]);for(var d=0,v=h.allKeys;d<v.length;d++){var p=v[d];n=t.pieces[p],r=f[p],n?r?h.samePiece(n,r.piece)||(c.push(r),l.push(m(p,n))):l.push(m(p,n)):r&&c.push(r)}return l.forEach(function(t){var n,e;n=t,e=c.filter(function(e){return h.samePiece(t.piece,e.piece)}),(r=e.sort(function(e,t){return h.distanceSq(n.pos,e.pos)-h.distanceSq(n.pos,t.pos)})[0])&&(i=[r.pos[0]-t.pos[0],r.pos[1]-t.pos[1]],a[t.key]=i.concat(i),u.push(r.key))}),c.forEach(function(e){h.containsX(u,e.key)||t.items&&t.items(e.pos,e.key)||(s[e.key]=e.piece)}),{anims:a,fadings:s}}(n,t);if(u(o.anims)&&u(o.fadings))t.dom.redraw();else{var i=t.animation.current&&t.animation.current.start;t.animation.current={start:c.now(),frequency:1/t.animation.duration,plan:o},i||function t(n,e){var r=n.animation.current;if(void 0!==r){var o,i=1-(e-r.start)*r.frequency;if(i<=0)n.animation.current=void 0,n.dom.redrawNow();else{var a=(o=i)<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1;for(var u in r.plan.anims){var s=r.plan.anims[u];s[2]=s[0]*a,s[3]=s[1]*a}n.dom.redrawNow(!0),h.raf(function(e){return void 0===e&&(e=c.now()),t(n,e)})}}else n.dom.destroyed||n.dom.redrawNow()}(t,c.now())}return r}(e,t):r(e,t)},n.render=r;var c=void 0!==window.performance?window.performance:Date;function u(e){for(var t in e)return!1;return!0}},{"./util":17}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./board"),i=e("./fen"),a=e("./config"),u=e("./anim"),s=e("./drag"),c=e("./explosion");n.start=function(r,e){function n(){o.toggleOrientation(r),e()}return{set:function(t){t.orientation&&t.orientation!==r.orientation&&n(),(t.fen?u.anim:u.render)(function(e){return a.configure(e,t)},r)},state:r,getFen:function(){return i.write(r.pieces)},toggleOrientation:n,setPieces:function(t){u.anim(function(e){return o.setPieces(e,t)},r)},selectSquare:function(t,n){t?u.anim(function(e){return o.selectSquare(e,t,n)},r):r.selected&&(o.unselect(r),r.dom.redraw())},move:function(t,n){u.anim(function(e){return o.baseMove(e,t,n)},r)},newPiece:function(t,n){u.anim(function(e){return o.baseNewPiece(e,t,n)},r)},playPremove:function(){if(r.premovable.current){if(u.anim(o.playPremove,r))return!0;r.dom.redraw()}return!1},playPredrop:function(e){if(r.predroppable.current){var t=o.playPredrop(r,e);return r.dom.redraw(),t}return!1},cancelPremove:function(){u.render(o.unsetPremove,r)},cancelPredrop:function(){u.render(o.unsetPredrop,r)},cancelMove:function(){u.render(function(e){o.cancelMove(e),s.cancel(e)},r)},stop:function(){u.render(function(e){o.stop(e),s.cancel(e)},r)},explode:function(e){c.default(r,e)},setAutoShapes:function(t){u.render(function(e){return e.drawable.autoShapes=t},r)},setShapes:function(t){u.render(function(e){return e.drawable.shapes=t},r)},getKeyAtDomPos:function(e){return o.getKeyAtDomPos(e,"white"===r.orientation,r.dom.bounds())},redrawAll:e,dragNewPiece:function(e,t,n){s.dragNewPiece(r,e,t,n)},destroy:function(){o.stop(r),r.dom.unbind&&r.dom.unbind(),r.dom.destroyed=!0}}}},{"./anim":2,"./board":4,"./config":6,"./drag":7,"./explosion":10,"./fen":11}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var v=e("./util"),p=e("./premove");function m(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function g(e){e.premovable.current&&(e.premovable.current=void 0,m(e.premovable.events.unset))}function b(e){var t=e.predroppable;t.current&&(t.current=void 0,m(t.events.unset))}function o(e,t,n){if(t===n||!e.pieces[t])return!1;var r=e.pieces[n]&&e.pieces[n].color!==e.pieces[t].color?e.pieces[n]:void 0;return n==e.selected&&k(e),m(e.events.move,t,n,r),function(e,t,n){if(!e.autoCastle)return!1;var r=e.pieces[t];if("king"!==r.role)return!1;var o=v.key2pos(t);if(5!==o[0])return!1;if(1!==o[1]&&8!==o[1])return!1;var i,a,u,s=v.key2pos(n);if(7===s[0]||8===s[0])i=v.pos2key([8,o[1]]),a=v.pos2key([6,o[1]]),u=v.pos2key([7,o[1]]);else{if(3!==s[0]&&1!==s[0])return!1;i=v.pos2key([1,o[1]]),a=v.pos2key([4,o[1]]),u=v.pos2key([3,o[1]])}var c=e.pieces[i];return"rook"===c.role&&(delete e.pieces[t],delete e.pieces[i],e.pieces[u]=r,e.pieces[a]=c,!0)}(e,t,n)||(e.pieces[n]=e.pieces[t],delete e.pieces[t]),e.lastMove=[t,n],e.check=void 0,m(e.events.change),r||!0}function y(e,t,n,r){if(e.pieces[n]){if(!r)return!1;delete e.pieces[n]}return m(e.events.dropNewPiece,t,n),e.pieces[n]=t,e.lastMove=[n],e.check=void 0,m(e.events.change),e.movable.dests=void 0,e.turnColor=v.opposite(e.turnColor),!0}function h(e,t,n){var r=o(e,t,n);return r&&(e.movable.dests=void 0,e.turnColor=v.opposite(e.turnColor),e.animation.current=void 0),r}function r(e,t,n){if(x(e,t,n)){var r=h(e,t,n);if(r){var o=e.hold.stop();k(e);var i={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return!0!==r&&(i.captured=r),m(e.movable.events.after,t,n,i),!0}}else l=e,(f=t)!==(d=n)&&C(l,f)&&v.containsX(p.default(l.pieces,f,l.premovable.castle),d)?(u=t,s=n,c={ctrlKey:(a=e).stats.ctrlKey},b(a),a.premovable.current=[u,s],m(a.premovable.events.set,u,s,c),k(e)):P(e,n)||C(e,n)?(w(e,n),e.hold.start()):k(e);var a,u,s,c,l,f,d;return!1}function w(e,t){e.selected=t,C(e,t)?e.premovable.dests=p.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function k(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function P(e,t){var n=e.pieces[t];return n&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}function x(e,t,n){return t!==n&&P(e,t)&&(e.movable.free||!!e.movable.dests&&v.containsX(e.movable.dests[t],n))}function C(e,t){var n=e.pieces[t];return n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}function i(e){g(e),b(e),k(e)}n.callUserFunction=m,n.toggleOrientation=function(e){e.orientation=v.opposite(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0},n.reset=function(e){e.lastMove=void 0,k(e),g(e),b(e)},n.setPieces=function(e,t){for(var n in t){var r=t[n];r?e.pieces[n]=r:delete e.pieces[n]}},n.setCheck=function(e,t){if(!0===t&&(t=e.turnColor),t)for(var n in e.pieces)"king"===e.pieces[n].role&&e.pieces[n].color===t&&(e.check=n);else e.check=void 0},n.unsetPremove=g,n.unsetPredrop=b,n.baseMove=o,n.baseNewPiece=y,n.userMove=r,n.dropNewPiece=function(e,t,n,r){if(v=t,p=n,(h=(d=e).pieces[v])&&p&&(v===p||!d.pieces[p])&&("both"===d.movable.color||d.movable.color===h.color&&d.turnColor===h.color)||r){var o=e.pieces[t];delete e.pieces[t],y(e,o,n,r),m(e.movable.events.afterNewPiece,o.role,n,{predrop:!1})}else c=t,l=n,(f=(s=e).pieces[c])&&l&&(!s.pieces[l]||s.pieces[l].color!==s.movable.color)&&s.predroppable.enabled&&("pawn"!==f.role||"1"!==l[1]&&"8"!==l[1])&&s.movable.color===f.color&&s.turnColor!==f.color?(a=(i=e).pieces[t].role,u=n,g(i),i.predroppable.current={role:a,key:u},m(i.predroppable.events.set,a,u)):(g(e),b(e));var i,a,u,s,c,l,f,d,v,p,h;delete e.pieces[t],k(e)},n.selectSquare=function(e,t,n){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||n)&&e.selected!==t?r(e,e.selected,t)&&(e.stats.dragged=!1):e.hold.start():(k(e),e.hold.cancel()):(P(e,t)||C(e,t))&&(w(e,t),e.hold.start()),m(e.events.select,t)},n.setSelected=w,n.unselect=k,n.canMove=x,n.isDraggable=function(e,t){var n=e.pieces[t];return n&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))},n.playPremove=function(e){var t=e.premovable.current;if(!t)return!1;var n=t[0],r=t[1],o=!1;if(x(e,n,r)){var i=h(e,n,r);if(i){var a={premove:!0};!0!==i&&(a.captured=i),m(e.movable.events.after,n,r,a),o=!0}}return g(e),o},n.playPredrop=function(e,t){var n=e.predroppable.current,r=!1;return!!n&&(t(n)&&y(e,{role:n.role,color:e.movable.color},n.key)&&(m(e.movable.events.afterNewPiece,n.role,n.key,{predrop:!0}),r=!0),b(e),r)},n.cancelMove=i,n.stop=function(e){e.movable.color=e.movable.dests=e.animation.current=void 0,i(e)},n.getKeyAtDomPos=function(e,t,n){var r=Math.ceil((e[0]-n.left)/n.width*8);t||(r=9-r);var o=Math.ceil(8-(e[1]-n.top)/n.height*8);return t||(o=9-o),0<r&&r<9&&0<o&&o<9?v.pos2key([r,o]):void 0}},{"./premove":12,"./util":17}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=e("./config"),i=e("./state"),l=e("./wrap"),f=e("./events"),d=e("./render"),v=e("./svg"),p=e("./util");n.Chessground=function(u,e){var s=i.defaults();function c(){var e=s.dom&&s.dom.unbind;u.classList.add("cg-board-wrap");var t,n,r=p.memo(function(){return u.getBoundingClientRect()}),o=s.viewOnly&&!s.drawable.visible,i=l.default(u,s,o?void 0:r()),a=function(e){d.default(s),!e&&i.svg&&v.renderSvg(s,i.svg)};s.dom={elements:i,bounds:r,redraw:(t=a,n=!1,function(){n||(n=!0,p.raf(function(){t(),n=!1}))}),redrawNow:a,unbind:e,relative:o},s.drawable.prevSvgHash="",a(!1),f.bindBoard(s),e||(s.dom.unbind=f.bindDocument(s,c))}return o.configure(s,e||{}),c(),r.start(s,c)}},{"./api":3,"./config":6,"./events":9,"./render":13,"./state":14,"./svg":15,"./util":17,"./wrap":18}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./board"),a=e("./fen");function u(e){return"object"==typeof e}n.configure=function(e,t){if(t.movable&&t.movable.dests&&(e.movable.dests=void 0),function e(t,n){for(var r in n)u(t[r])&&u(n[r])?e(t[r],n[r]):t[r]=n[r]}(e,t),t.fen&&(e.pieces=a.read(t.fen),e.drawable.shapes=[]),t.hasOwnProperty("check")&&i.setCheck(e,t.check||!1),t.hasOwnProperty("lastMove")&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&i.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){var n="white"===e.movable.color?1:8,r="e"+n,o=e.movable.dests[r];if(!o||"king"!==e.pieces[r].role)return;e.movable.dests[r]=o.filter(function(e){return!(e==="a"+n&&-1!==o.indexOf("c"+n)||e==="h"+n&&-1!==o.indexOf("g"+n))})}}},{"./board":4,"./fen":11}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var p=e("./board"),h=e("./util"),m=e("./draw"),g=e("./anim");function b(a){h.raf(function(){var e=a.draggable.current;if(e){a.animation.current&&a.animation.current.plan.anims[e.orig]&&(a.animation.current=void 0);var t=a.pieces[e.orig];if(t&&h.samePiece(t,e.piece)){if(!e.started&&h.distanceSq(e.epos,e.rel)>=Math.pow(a.draggable.distance,2)&&(e.started=!0),e.started){if("function"==typeof e.element){var n=e.element();if(!n)return;e.element=n,e.element.cgDragging=!0,e.element.classList.add("dragging")}var r="white"===a.orientation,o=a.dom.bounds();e.pos=[e.epos[0]-e.rel[0],e.epos[1]-e.rel[1]];var i=h.posToTranslateAbs(o)(e.origPos,r);i[0]+=e.pos[0]+e.dec[0],i[1]+=e.pos[1]+e.dec[1],h.translateAbs(e.element,i)}}else u(a);b(a)}})}function u(e){var t=e.draggable.current;t&&(t.newPiece&&delete e.pieces[t.orig],e.draggable.current=void 0,p.unselect(e),i(e),e.dom.redraw())}function i(e){var t=e.dom.elements;t.ghost&&h.setVisible(t.ghost,!1)}function y(e,t,n){var r=h.key2pos(e);return t||(r[0]=9-r[0],r[1]=9-r[1]),{left:n.left+n.width*(r[0]-1)/8,top:n.top+n.height*(8-r[1])/8,width:n.width/8,height:n.height/8}}function w(e,t){for(var n=e.dom.elements.board.firstChild;n;){if(n.cgKey===t&&"PIECE"===n.tagName)return n;n=n.nextSibling}}n.start=function(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&1<t.touches.length)){t.preventDefault();var n="white"===e.orientation,r=e.dom.bounds(),o=h.eventPosition(t),i=p.getKeyAtDomPos(o,n,r);if(i){var a=e.pieces[i],u=e.selected;u||!e.drawable.enabled||!e.drawable.eraseOnClick&&a&&a.color===e.turnColor||m.clear(e);var s=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&p.canMove(e,e.selected,i)?g.anim(function(e){return p.selectSquare(e,i)},e):p.selectSquare(e,i);var l=e.selected===i,f=w(e,i);if(a&&f&&l&&p.isDraggable(e,i)){var d=y(i,n,r);e.draggable.current={orig:i,origPos:h.key2pos(i),piece:a,rel:o,epos:o,pos:[0,0],dec:e.draggable.centerPiece?[o[0]-(d.left+d.width/2),o[1]-(d.top+d.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:f,previouslySelected:u,originTarget:t.target},f.cgDragging=!0,f.classList.add("dragging");var v=e.dom.elements.ghost;v&&(v.className="ghost "+a.color+" "+a.role,h.translateAbs(v,h.posToTranslateAbs(r)(h.key2pos(i),n)),h.setVisible(v,!0)),b(e)}else s&&p.unsetPremove(e),c&&p.unsetPredrop(e);e.dom.redraw()}}},n.dragNewPiece=function(e,t,n,r){var o="a0";e.pieces.a0=t,e.dom.redraw();var i=h.eventPosition(n),a="white"===e.orientation,u=e.dom.bounds(),s=y(o,a,u),c=[(a?0:7)*s.width+u.left,(a?8:-1)*s.height+u.top];e.draggable.current={orig:o,origPos:h.key2pos(o),piece:t,rel:c,epos:i,pos:[i[0]-c[0],i[1]-c[1]],dec:[-s.width/2,-s.height/2],started:!0,element:function(){return w(e,o)},originTarget:n.target,newPiece:!0,force:r||!1},b(e)},n.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=h.eventPosition(t))},n.end=function(e,t){var n=e.draggable.current;if(n)if("touchend"!==t.type||!n||n.originTarget===t.target||n.newPiece){p.unsetPremove(e),p.unsetPredrop(e);var r=h.eventPosition(t)||n.epos,o=p.getKeyAtDomPos(r,"white"===e.orientation,e.dom.bounds());o&&n.started?n.newPiece?p.dropNewPiece(e,n.orig,o,n.force):(e.stats.ctrlKey=t.ctrlKey,p.userMove(e,n.orig,o)&&(e.stats.dragged=!0)):n.newPiece?delete e.pieces[n.orig]:e.draggable.deleteOnDropOff&&(delete e.pieces[n.orig],p.callUserFunction(e.events.change)),(!n||n.orig!==n.previouslySelected||n.orig!==o&&o)&&e.selectable.enabled||p.unselect(e),i(e),e.draggable.current=void 0,e.dom.redraw()}else e.draggable.current=void 0},n.cancel=u},{"./anim":2,"./board":4,"./draw":8,"./util":17}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u=e("./board"),s=e("./util"),c=["green","red","blue","yellow"];function l(n){s.raf(function(){var e=n.drawable.current;if(e){var t=u.getKeyAtDomPos(e.pos,"white"===n.orientation,n.dom.bounds());t!==e.mouseSq&&(e.mouseSq=t,e.dest=t!==e.orig?t:void 0,n.dom.redrawNow()),l(n)}})}function f(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function d(e){e.onChange&&e.onChange(e.shapes)}n.start=function(e,t){if(!(t.touches&&1<t.touches.length)){t.stopPropagation(),t.preventDefault(),t.ctrlKey?u.unselect(e):u.cancelMove(e);var n,r,o,i=s.eventPosition(t),a=u.getKeyAtDomPos(i,"white"===e.orientation,e.dom.bounds());a&&(e.drawable.current={orig:a,pos:i,brush:(n=t,r=n.shiftKey&&s.isRightButton(n)?1:0,o=n.altKey?2:0,c[r+o])},l(e))}},n.processDraw=l,n.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=s.eventPosition(t))},n.end=function(e){var t=e.drawable.current;t&&(t.mouseSq&&(n=e.drawable,r=t,i=function(e){return e.orig===r.orig&&e.dest===r.dest},a=n.shapes.filter(i)[0],a&&(n.shapes=n.shapes.filter((o=i,function(e){return!o(e)}))),a&&a.brush===r.brush||n.shapes.push(r),d(n)),f(e));var n,r,o,i,a},n.cancel=f,n.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),d(e.drawable))}},{"./board":4,"./util":17}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=e("./drag"),u=e("./draw"),s=e("./util");function c(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n)}}function l(t,n,r){return function(e){e.shiftKey||s.isRightButton(e)?t.drawable.enabled&&r(t,e):t.viewOnly||n(t,e)}}n.bindBoard=function(e){if(!e.viewOnly){var t,n=e.dom.elements.board,r=(t=e,function(e){t.draggable.current?a.cancel(t):t.drawable.current?u.cancel(t):e.shiftKey||s.isRightButton(e)?t.drawable.enabled&&u.start(t,e):t.viewOnly||a.start(t,e)});n.addEventListener("touchstart",r),n.addEventListener("mousedown",r),(e.disableContextMenu||e.drawable.enabled)&&n.addEventListener("contextmenu",function(e){return e.preventDefault()})}},n.bindDocument=function(e,t){var n=[];!e.dom.relative&&e.resizable&&n.push(c(document.body,"chessground.resize",function(){e.dom.bounds.clear(),s.raf(t)}));if(!e.viewOnly){var r=l(e,a.move,u.move),o=l(e,a.end,u.end);["touchmove","mousemove"].forEach(function(e){return n.push(c(document,e,r))}),["touchend","mouseup"].forEach(function(e){return n.push(c(document,e,o))});var i=function(){return e.dom.bounds.clear()};n.push(c(window,"scroll",i,{passive:!0})),n.push(c(window,"resize",i,{passive:!0}))}return function(){return n.forEach(function(e){return e()})}}},{"./drag":7,"./draw":8,"./util":17}],10:[function(e,t,n){"use strict";function r(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){r(e,2),setTimeout(function(){return r(e,void 0)},120)},120)}},{}],11:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var l=e("./util"),i=e("./types");c.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";var f={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},a={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};c.read=function(e){"start"===e&&(e=c.initial);for(var t={},n=8,r=0,o=0,i=e;o<i.length;o++){var a=i[o];switch(a){case" ":return t;case"/":if(0==--n)return t;r=0;break;case"~":t[l.pos2key([r,n])].promoted=!0;break;default:var u=a.charCodeAt(0);if(u<57)r+=u-48;else{++r;var s=a.toLowerCase();t[l.pos2key([r,n])]={role:f[s],color:a===s?"black":"white"}}}}return t},c.write=function(n){var r,o;return l.invRanks.map(function(t){return i.ranks.map(function(e){return(r=n[l.pos2key([e,t])])?(o=a[r.role],"white"===r.color?o.toUpperCase():o):"1"}).join("")}).join("/").replace(/1{2,}/g,function(e){return e.length.toString()})}},{"./types":16,"./util":17}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var v=e("./util");function p(e,t){return Math.abs(e-t)}var h=function(e,t,n,r){var o=p(e,n),i=p(t,r);return 1===o&&2===i||2===o&&1===i},m=function(e,t,n,r){return p(e,n)===p(t,r)},g=function(e,t,n,r){return e===n||t===r},b=function(e,t,n,r){return m(e,t,n,r)||g(e,t,n,r)};n.default=function(e,t,n){var r,o,i,a,u,s,c,l,f=e[t],d=v.key2pos(t);switch(f.role){case"pawn":l=f.color,r=function(e,t,n,r){return p(e,n)<2&&("white"===l?r===t+1||t<=2&&r===t+2&&e===n:r===t-1||7<=t&&r===t-2&&e===n)};break;case"knight":r=h;break;case"bishop":r=m;break;case"rook":r=g;break;case"queen":r=b;break;case"king":o=f.color,u=e,s=f.color,i=Object.keys(u).filter(function(e){return(c=u[e])&&c.color===s&&"rook"===c.role}).map(function(e){return v.key2pos(e)[0]}),a=n,r=function(e,t,n,r){return p(e,n)<2&&p(t,r)<2||a&&t===r&&t===("white"===o?1:8)&&(5===e&&(3===n||7===n)||v.containsX(i,n))}}return v.allKeys.map(v.key2pos).filter(function(e){return(d[0]!==e[0]||d[1]!==e[1])&&r(d[0],d[1],e[0],e[1])}).map(v.pos2key)}},{"./util":17}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var L=e("./util"),j=e("./util");function B(e,t){for(var n in t)e.dom.elements.board.removeChild(t[n])}function D(e,t){var n=2+8*(e[1]-1)+(8-e[0]);return t&&(n=67-n),n+""}function q(e){return e.color+" "+e.role}function Q(e,t,n){e[t]?e[t]+=" "+n:e[t]=n}n.default=function(e){var t,n,r,o,i,a,u,s,c,l,f,d="white"===e.orientation,v=e.dom.relative?j.posToTranslateRel:j.posToTranslateAbs(e.dom.bounds()),p=e.dom.relative?j.translateRel:j.translateAbs,h=e.dom.elements.board,m=e.pieces,g=e.animation.current,b=g?g.plan.anims:{},y=g?g.plan.fadings:{},w=e.draggable.current,k=function(e){var t,n,r={};if(e.lastMove&&e.highlight.lastMove)for(t in e.lastMove)Q(r,e.lastMove[t],"last-move");if(e.check&&e.highlight.check&&Q(r,e.check,"check"),e.selected&&(Q(r,e.selected,"selected"),e.movable.showDests)){var o=e.movable.dests&&e.movable.dests[e.selected];if(o)for(t in o)n=o[t],Q(r,n,"move-dest"+(e.pieces[n]?" oc":""));var i=e.premovable.dests;if(i)for(t in i)n=i[t],Q(r,n,"premove-dest"+(e.pieces[n]?" oc":""))}var a=e.premovable.current;if(a)for(t in a)Q(r,a[t],"current-premove");else e.predroppable.current&&Q(r,e.predroppable.current.key,"current-premove");var u=e.exploding;if(u)for(t in u.keys)Q(r,u.keys[t],"exploding"+u.stage);return r}(e),P={},x={},C={},E={},_=Object.keys(m);for(r=h.firstChild;r;){if(t=r.cgKey,"PIECE"===r.tagName)o=m[t],a=b[t],u=y[t],i=r.cgPiece,!r.cgDragging||w&&w.orig===t||(r.classList.remove("dragging"),p(r,v(L.key2pos(t),d)),r.cgDragging=!1),!u&&r.cgFading&&(r.cgFading=!1,r.classList.remove("fading")),o?(a&&r.cgAnimating&&i===q(o)?((R=L.key2pos(t))[0]+=a[2],R[1]+=a[3],r.classList.add("anim"),p(r,v(R,d))):r.cgAnimating&&(r.cgAnimating=!1,r.classList.remove("anim"),p(r,v(L.key2pos(t),d)),e.addPieceZIndex&&(r.style.zIndex=D(L.key2pos(t),d))),i!==q(o)||u&&r.cgFading?u&&i===q(u)?(r.classList.add("fading"),r.cgFading=!0):C[i]?C[i].push(r):C[i]=[r]:P[t]=!0):C[i]?C[i].push(r):C[i]=[r];else if("SQUARE"===r.tagName){var A=r.className;k[t]===A?x[t]=!0:E[A]?E[A].push(r):E[A]=[r]}r=r.nextSibling}for(var O in k)if(!x[O]){f=(l=E[k[O]])&&l.pop();var N=v(L.key2pos(O),d);if(f)f.cgKey=O,p(f,N);else{var S=L.createEl("square",k[O]);S.cgKey=O,p(S,N),h.insertBefore(S,h.firstChild)}}for(var M in _)if(n=m[t=_[M]],a=b[t],!P[t])if(c=(s=C[q(n)])&&s.pop()){c.cgKey=t,c.cgFading&&(c.classList.remove("fading"),c.cgFading=!1);var R=L.key2pos(t);e.addPieceZIndex&&(c.style.zIndex=D(R,d)),a&&(c.cgAnimating=!0,c.classList.add("anim"),R[0]+=a[2],R[1]+=a[3]),p(c,v(R,d))}else{var T=q(n),K=L.createEl("piece",T);R=L.key2pos(t),K.cgPiece=T,K.cgKey=t,a&&(K.cgAnimating=!0,R[0]+=a[2],R[1]+=a[3]),p(K,v(R,d)),e.addPieceZIndex&&(K.style.zIndex=D(R,d)),h.appendChild(K)}for(var I in C)B(e,C[I]);for(var I in E)B(e,E[I])}},{"./util":17}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./fen"),o=e("./util");n.defaults=function(){return{pieces:r.read(r.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"},prevSvgHash:""},hold:o.timer()}}},{"./fen":11,"./util":17}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var W,F=e("./util");function H(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function c(e,t,n){var r,o,i=e.orig,a=e.dest,u=e.brush,s=e.piece,c=e.modifiers;return[n,i,a,u,a&&1<t[a],s&&(o=s,[o.color,o.role,o.scale].filter(function(e){return e}).join("")),c&&(r=c,""+(r.lineWidth||""))].filter(function(e){return e}).join("")}function l(e){var t=$(H("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild($(H("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function $(e,t){for(var n in t)e.setAttribute(n,t[n]);return e}function X(e,t){return"white"===t?e:[9-e[0],9-e[1]]}function G(e,t){var n={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return n.key=[e.key,t.lineWidth].filter(function(e){return e}).join(""),n}function Z(e,t){return(e.opacity||1)*(t?.9:1)}function V(e,t){return[(e[0]-.5)*t.width/8,(8.5-e[1])*t.height/8]}n.createElement=H,n.renderSvg=function(e,t){var n=e.drawable,r=n.current,o=r&&r.mouseSq?r:void 0,i={};n.shapes.concat(n.autoShapes).concat(o?[o]:[]).forEach(function(e){e.dest&&(i[e.dest]=(i[e.dest]||0)+1)});var a=n.shapes.concat(n.autoShapes).map(function(e){return{shape:e,current:!1,hash:c(e,i,!1)}});o&&a.push({shape:o,current:!0,hash:c(o,i,!0)});var u=a.map(function(e){return e.hash}).join("");if(u!==e.drawable.prevSvgHash){e.drawable.prevSvgHash=u;var s=t.firstChild;!function(t,e,n){var r,o={};e.forEach(function(e){e.shape.dest&&(r=t.brushes[e.shape.brush],e.shape.modifiers&&(r=G(r,e.shape.modifiers)),o[r.key]=r)});for(var i={},a=n.firstChild;a;)i[a.getAttribute("cgKey")]=!0,a=a.nextSibling;for(var u in o)i[u]||n.appendChild(l(o[u]))}(n,a,s),function(t,e,n,r,o,i){void 0===W&&(W=F.computeIsTrident());var a=t.dom.bounds(),u={},s=[];e.forEach(function(e){u[e.hash]=!1});for(var c,l=i.nextSibling;l;)c=l.getAttribute("cgHash"),u.hasOwnProperty(c)?u[c]=!0:s.push(l),l=l.nextSibling;s.forEach(function(e){return o.removeChild(e)}),e.forEach(function(e){u[e.hash]||o.appendChild(function(e,t,n,r,o){var i,a,u,s,c,l,f,d,v,p,h,m,g,b,y,w,k,P,x,C,E,_,A,O,N,S,M,R,T,K,I,L,j,B,D=t.shape,q=t.current,Q=t.hash;if(D.piece)R=e.drawable.pieces.baseUrl,T=X(F.key2pos(D.orig),e.orientation),K=D.piece,L=V(T,I=o),j=I.width/8*(K.scale||1),B=K.color[0]+("knight"===K.role?"n":K.role[0]).toUpperCase(),i=$(H("image"),{className:K.role+" "+K.color,x:L[0]-j/2,y:L[1]-j/2,width:j,height:j,href:R+B+".svg"});else{var U=X(F.key2pos(D.orig),e.orientation);if(D.orig&&D.dest){var z=n[D.brush];D.modifiers&&(z=G(z,D.modifiers)),v=z,p=U,h=X(F.key2pos(D.dest),e.orientation),m=q,g=1<r[D.dest],A=b=o,O=g&&!m,y=W?0:(O?20:10)/512*A.width,w=V(p,b),k=V(h,b),P=k[0]-w[0],x=k[1]-w[1],C=Math.atan2(x,P),E=Math.cos(C)*y,_=Math.sin(C)*y,i=$(H("line"),{stroke:v.color,"stroke-width":(N=v,S=m,M=b,(N.lineWidth||10)*(S?.85:1)/512*M.width),"stroke-linecap":"round","marker-end":W?void 0:"url(#arrowhead-"+v.key+")",opacity:Z(v,m),x1:w[0],y1:w[1],x2:k[0]-E,y2:k[1]-_})}else a=n[D.brush],u=q,c=V(U,s=o),d=s.width/512,l=[3*d,4*d],f=(s.width+s.height)/32,i=$(H("circle"),{stroke:a.color,"stroke-width":l[u?0:1],fill:"none",opacity:Z(a,u),cx:c[0],cy:c[1],r:f-l[1]/2})}return i.setAttribute("cgHash",Q),i}(t,e,n,r,a))})}(e,a,n.brushes,i,t,s)}}},{"./util":17}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.files=["a","b","c","d","e","f","g","h"],n.ranks=[1,2,3,4,5,6,7,8]},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./types");n.colors=["white","black"],n.invRanks=[8,7,6,5,4,3,2,1],n.allKeys=(o=Array.prototype).concat.apply(o,r.files.map(function(t){return r.ranks.map(function(e){return t+e})})),n.pos2key=function(e){return n.allKeys[8*e[0]+e[1]-9]},n.key2pos=function(e){return[e.charCodeAt(0)-96,e.charCodeAt(1)-48]},n.memo=function(e){var t,n=function(){return void 0===t&&(t=e()),t};return n.clear=function(){t=void 0},n},n.timer=function(){var t;return{start:function(){t=Date.now()},cancel:function(){t=void 0},stop:function(){if(!t)return 0;var e=Date.now()-t;return t=void 0,e}}},n.opposite=function(e){return"white"===e?"black":"white"},n.containsX=function(e,t){return void 0!==e&&-1!==e.indexOf(t)},n.distanceSq=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},n.samePiece=function(e,t){return e.role===t.role&&e.color===t.color},n.computeIsTrident=function(){return-1<window.navigator.userAgent.indexOf("Trident/")};var o,i=function(e,t,n,r){return[(t?e[0]-1:8-e[0])*n,(t?8-e[1]:e[1]-1)*r]};n.posToTranslateAbs=function(e){var n=e.width/8,r=e.height/8;return function(e,t){return i(e,t,n,r)}},n.posToTranslateRel=function(e,t){return i(e,t,12.5,12.5)},n.translateAbs=function(e,t){e.style.transform="translate("+t[0]+"px,"+t[1]+"px)"},n.translateRel=function(e,t){e.style.left=t[0]+"%",e.style.top=t[1]+"%"},n.setVisible=function(e,t){e.style.visibility=t?"visible":"hidden"},n.eventPosition=function(e){return e.clientX||0===e.clientX?[e.clientX,e.clientY]:e.touches&&e.targetTouches[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0},n.isRightButton=function(e){return 2===e.buttons||2===e.button},n.createEl=function(e,t){var n=document.createElement(e);return t&&(n.className=t),n},n.raf=(window.requestAnimationFrame||window.setTimeout).bind(window)},{"./types":16}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u=e("./util"),s=e("./types"),c=e("./svg");function l(e,t){var n,r=u.createEl("coords",t);for(var o in e)(n=u.createEl("coord")).textContent=e[o],r.appendChild(n);return r}n.default=function(t,n,e){t.innerHTML="",t.classList.add("cg-board-wrap"),u.colors.forEach(function(e){t.classList.toggle("orientation-"+e,n.orientation===e)}),t.classList.toggle("manipulable",!n.viewOnly);var r,o,i=u.createEl("div","cg-board");if(t.appendChild(i),n.drawable.visible&&e&&((r=c.createElement("svg")).appendChild(c.createElement("defs")),t.appendChild(r)),n.coordinates){var a="black"===n.orientation?" black":"";t.appendChild(l(s.ranks,"ranks"+a)),t.appendChild(l(s.files,"files"+a))}return e&&n.draggable.showGhost&&(o=u.createEl("piece","ghost"),u.setVisible(o,!1),t.appendChild(o)),{board:i,ghost:o,svg:r}}},{"./svg":15,"./types":16,"./util":17}],19:[function(e,be,ye){!function(p,n,f,X,s,G){var h=v(function(n,r){var o=r.length;return v(function(e){for(var t=0;t<e.length;t++)r[o+t]=e[t];return r.length=o+e.length,n.apply(this,r)})});v(function(e){var t=N(e);function n(e,t){return[d(e,t)]}return v(function(e){return M(n,e,t)[0]})});function m(e,t){return function(){return e.call(this,t.apply(this,arguments))}}function r(t){return function(e){return e[t]}}var g=v(function(r){return v(function(e){for(var t,n=0;n<P(r);n++)if(t=d(e,r[n]))return t})});function d(e,t){return t.apply(G,e)}function v(t){var n=t.length-1,r=f.prototype.slice;if(0==n)return function(){return t.call(this,r.call(arguments))};if(1==n)return function(){return t.call(this,arguments[0],r.call(arguments,1))};var o=f(t.length);return function(){for(var e=0;e<n;e++)o[e]=arguments[e];return o[n]=r.call(arguments,n),t.apply(this,o)}}function b(t,n){return function(e){return t(e)&&n(e)}}function y(){}function w(){return!0}function k(e,t){return t&&t.constructor===e}var P=r("length"),x=h(k,String);function C(e){return e!==G}function E(e,t){return t instanceof n&&function e(t,n){return!n||t(A(n))&&e(t,O(n))}(function(e){return e in t},e)}function _(e,t){return[e,t]}var o=null,A=r(0),O=r(1);function N(e){return R(e.reduce((n=_,function(e,t){return n(t,e)}),o));var n}var S=v(N);function u(e){return M(function(e,t){return e.unshift(t),e},[],e)}function c(e,t){return t?_(e(A(t)),c(e,O(t))):o}function M(e,t,n){return n?e(M(e,t,O(n)),A(n)):t}function l(e,r,t){return function e(t,n){return t?r(A(t))?(n(A(t)),O(t)):_(A(t),e(O(t),n)):o}(e,t||y)}function R(e){return function e(t,n){return t?e(O(t),_(A(t),n)):n}(e,o)}function a(e){"use strict";var i,a,u,s=e(ce).emit,c=e(le).emit,l=e(fe).emit,t=e(ne).emit,f=65536,d=/[\\"\n]/g,n=0,v=n++,p=n++,h=n++,m=n++,g=n++,b=n++,y=n++,w=n++,k=n++,P=n++,x=n++,C=n++,E=n++,_=n++,A=n++,O=n++,N=n++,S=n++,M=n++,R=n++,T=f,K=G,I="",L=!1,j=!1,B=v,D=[],q=null,Q=0,U=0,z=0,W=0,F=1;function H(e){K!==G&&(c(K),l(),K=G),i=X(e+"\nLn: "+F+"\nCol: "+W+"\nChr: "+a),t(de(G,G,i))}function $(e){return"\r"==e||"\n"==e||" "==e||"\t"==e}e(ae).on(function(e){if(i)return;if(j)return H("Cannot write after close");var t=0;a=e[0];for(;a&&(0<t&&(u=a),a=e[t++]);)switch(z++,"\n"==a?(F++,W=0):W++,B){case v:if("{"===a)B=h;else if("["===a)B=g;else if(!$(a))return H("Non-whitespace before {[.");continue;case w:case h:if($(a))continue;if(B===w)D.push(k);else{if("}"===a){c({}),l(),B=D.pop()||p;continue}D.push(m)}if('"'!==a)return H('Malformed object key should start with " ');B=y;continue;case k:case m:if($(a))continue;if(":"===a)B===m?(D.push(m),K!==G&&(c({}),s(K),K=G),U++):K!==G&&(s(K),K=G),B=p;else if("}"===a)K!==G&&(c(K),l(),K=G),l(),U--,B=D.pop()||p;else{if(","!==a)return H("Bad object");B===m&&D.push(m),K!==G&&(c(K),l(),K=G),B=w}continue;case g:case p:if($(a))continue;if(B===g){if(c([]),U++,B=p,"]"===a){l(),U--,B=D.pop()||p;continue}D.push(b)}if('"'===a)B=y;else if("{"===a)B=h;else if("["===a)B=g;else if("t"===a)B=P;else if("f"===a)B=E;else if("n"===a)B=N;else if("-"===a)I+=a;else if("0"===a)I+=a,B=20;else{if(-1==="123456789".indexOf(a))return H("Bad value");I+=a,B=20}continue;case b:if(","===a)D.push(b),K!==G&&(c(K),l(),K=G),B=p;else{if("]"!==a){if($(a))continue;return H("Bad array")}K!==G&&(c(K),l(),K=G),l(),U--,B=D.pop()||p}continue;case y:K===G&&(K="");var n=t-1;e:for(;;){for(;0<Q;)if(q+=a,a=e.charAt(t++),4===Q?(K+=String.fromCharCode(parseInt(q,16)),Q=0,n=t-1):Q++,!a)break e;if('"'===a&&!L){B=D.pop()||p,K+=e.substring(n,t-1);break}if(!("\\"!==a||L||(L=!0,K+=e.substring(n,t-1),a=e.charAt(t++))))break;if(L){if(L=!1,"n"===a?K+="\n":"r"===a?K+="\r":"t"===a?K+="\t":"f"===a?K+="\f":"b"===a?K+="\b":"u"===a?(Q=1,q=""):K+=a,a=e.charAt(t++),n=t-1,a)continue;break}d.lastIndex=t;var r=d.exec(e);if(!r){t=e.length+1,K+=e.substring(n,t-1);break}if(t=r.index+1,!(a=e.charAt(r.index))){K+=e.substring(n,t-1);break}}continue;case P:if(!a)continue;if("r"!==a)return H("Invalid true started with t"+a);B=x;continue;case x:if(!a)continue;if("u"!==a)return H("Invalid true started with tr"+a);B=C;continue;case C:if(!a)continue;if("e"!==a)return H("Invalid true started with tru"+a);c(!0),l(),B=D.pop()||p;continue;case E:if(!a)continue;if("a"!==a)return H("Invalid false started with f"+a);B=_;continue;case _:if(!a)continue;if("l"!==a)return H("Invalid false started with fa"+a);B=A;continue;case A:if(!a)continue;if("s"!==a)return H("Invalid false started with fal"+a);B=O;continue;case O:if(!a)continue;if("e"!==a)return H("Invalid false started with fals"+a);c(!1),l(),B=D.pop()||p;continue;case N:if(!a)continue;if("u"!==a)return H("Invalid null started with n"+a);B=S;continue;case S:if(!a)continue;if("l"!==a)return H("Invalid null started with nu"+a);B=M;continue;case M:if(!a)continue;if("l"!==a)return H("Invalid null started with nul"+a);c(null),l(),B=D.pop()||p;continue;case R:if("."!==a)return H("Leading zero not followed by .");I+=a,B=20;continue;case 20:if(-1!=="0123456789".indexOf(a))I+=a;else if("."===a){if(-1!==I.indexOf("."))return H("Invalid number has two dots");I+=a}else if("e"===a||"E"===a){if(-1!==I.indexOf("e")||-1!==I.indexOf("E"))return H("Invalid number has two exponential");I+=a}else if("+"===a||"-"===a){if("e"!==u&&"E"!==u)return H("Invalid symbol in number");I+=a}else I&&(c(parseFloat(I)),l(),I=""),t--,B=D.pop()||p;continue;default:return H("Unknown state: "+B)}T<=z&&(o=0,K!==G&&K.length>f&&(H("Max buffer length exceeded: textNode"),o=Math.max(o,K.length)),I.length>f&&(H("Max buffer length exceeded: numberNode"),o=Math.max(o,I.length)),T=f-o+z);var o}),e(ue).on(function(){if(B==v)return c({}),l(),void(j=!0);B===p&&0===U||H("Unexpected end");K!==G&&(c(K),l(),K=G);j=!0})}var e,t,i,T,K,I,L,j,B,D,q,Q=(e=v(function(e){return e.unshift(/^/),(t=RegExp(e.map(r("source")).join(""))).exec.bind(t);var t}),T=e(t=/(\$?)/,/([\w-_]+|\*)/,i=/(?:{([\w ]*?)})?/),K=e(t,/\["([^"]+)"\]/,i),I=e(t,/\[(\d+|\*)\]/,i),L=e(t,/()/,/{([\w ]*?)}/),j=e(/\.\./),B=e(/\./),D=e(t,/!/),q=e(/$/),function(e){return e(g(T,K,I,L),j,B,D,q)});function U(e,t){return{key:e,node:t}}var z=r("key"),W=r("node"),F={};function H(e){var o=e(Y).emit,t=e(J).emit,s=e(oe).emit,n=e(re).emit;function c(e,t,n){W(A(e))[t]=n}function l(e,t,n){e&&c(e,t,n);var r=_(U(t,n),e);return o(r),r}var r={};return r[le]=function(e,t){if(!e)return s(t),l(e,F,t);var n,r,o,i=(r=t,o=W(A(n=e)),k(f,o)?l(n,P(o),r):n),a=O(i),u=z(A(i));return c(a,u,t),_(U(u,t),a)},r[fe]=function(e){return t(e),O(e)||n(W(A(e)))},r[ce]=l,r}var $=Q(function(e,t,n,r,o){var i=m(z,A),a=m(W,A);function u(e,t){return!!t[1]?b(e,A):e}function s(e){if(e==w)return w;return b(function(e){return i(e)!=F},m(e,O))}function c(){return function(e){return i(e)==F}}function l(e,t,n,r,o){var i,a=e(n);if(a){var u=(i=a,M(function(e,t){return t(e,i)},r,t));return o(n.substr(P(a[0])),u)}}function f(e,t){return h(l,e,t)}var d=g(f(e,S(u,function(e,t){var n=t[3];return n?b(m(h(E,N(n.split(/\W+/))),a),e):e},function(e,t){var n=t[2];return b(n&&"*"!=n?function(e){return i(e)==n}:w,e)},s)),f(t,S(function(e){if(e==w)return w;var t=c(),n=e,r=s(function(e){return o(e)}),o=g(t,n,r);return o})),f(n,S()),f(r,S(u,c)),f(o,S(function(n){return function(e){var t=n(e);return!0===t?A(e):t}})),function(e){throw X('"'+e+'" could not be tokenised')});function v(e,t){return t}function p(e,t){return d(e,t,e?p:v)}return function(t){try{return p(t,w)}catch(e){throw X('Could not compile "'+t+'" because '+e.message)}}});function Z(r,o,n){var i,a;function u(t){return function(e){return e.id==t}}return{on:function(e,t){var n={listener:e,id:t||e};return o&&o.emit(r,e,n.id),i=_(n,i),a=_(e,a),this},emit:function(){!function e(t,n){t&&(A(t).apply(null,n),e(O(t),n))}(a,arguments)},un:function(e){var t;i=l(i,u(e),function(e){t=e}),t&&(a=l(a,function(e){return e==t.listener}),n&&n.emit(r,t.listener,t.id))},listeners:function(){return a},hasListener:function(e){return C(function e(t,n){return n&&(t(A(n))?A(n):e(t,O(n)))}(e?u(e):w,i))}}}var V=1,Y=V++,J=V++,ee=V++,te=V++,ne="fail",re=V++,oe=V++,ie="start",ae="data",ue="end",se=V++,ce=V++,le=V++,fe=V++;function de(e,t,n){try{var r=s.parse(t)}catch(e){}return{statusCode:e,body:t,jsonBody:r,thrown:n}}function ve(r,o){var i={node:r(J),path:r(Y)};function a(t,n,i){var a=r(t).emit;n.on(function(e){var t,n,r,o=i(e);!1!==o&&(t=a,n=W(o),r=R(e),t(n,u(O(c(z,r))),u(c(W,r))))},t),r("removeListener").on(function(e){e==t&&(r(e).listeners()||n.un(t))})}r("newListener").on(function(e){var t=/(node|path):(.*)/.exec(e);if(t){var n=i[t[1]];n.hasListener(e)||a(e,n,o(t[2]))}})}function pe(i,e){var o,a=/^(node|path):./,u=i(re),s=i(te).emit,c=i(ee).emit,t=v(function(e,t){if(o[e])d(t,o[e]);else{var n=i(e),r=t[0];a.test(e)?l(n,r):n.on(r)}return o});function l(t,e,n){n=n||e;var r=f(e);return t.on(function(){var e=!1;o.forget=function(){e=!0},d(arguments,r),delete o.forget,e&&t.un(n)},n),o}function f(e){return function(){try{return e.apply(o,arguments)}catch(e){setTimeout(function(){throw new X(e.message)})}}}function r(e,t,n){var r,o;"node"==e?(o=n,r=function(){var e=o.apply(this,arguments);C(e)&&(e==ge.drop?s():c(e))}):r=n,l(i(e+":"+t),r,n)}function n(e,t,n){return x(t)?r(e,t,n):function(e,t){for(var n in t)r(e,n,t[n])}(e,t),o}return i(oe).on(function(e){var t;o.root=(t=e,function(){return t})}),i(ie).on(function(e,t){o.header=function(e){return e?t[e]:t}}),o={on:t,addListener:t,removeListener:function(e,t,n){if("done"==e)u.un(t);else if("node"==e||"path"==e)i.un(e+":"+t,n);else{var r=t;i(e).un(r)}return o},emit:i.emit,node:h(n,"node"),path:h(n,"path"),done:h(l,u),start:h(function(e,t){return i(e).on(f(t),t),o},ie),fail:i(ne).on,abort:i(se).emit,header:y,root:y,source:e}}function he(e,t,n,r,o){var i=function(){var t={},n=o("newListener"),r=o("removeListener");function o(e){return t[e]=Z(e,n,r)}function i(e){return t[e]||o(e)}return["emit","on","un"].forEach(function(n){i[n]=v(function(e,t){d(t,i(e)[n])})}),i}();return t&&function(t,r,e,n,o,i,a){"use strict";var u,s=t(ae).emit,c=t(ne).emit,l=0,f=!0;function d(){var e=r.responseText,t=e.substr(l);t&&s(t),l=P(e)}t(se).on(function(){r.onreadystatechange=null,r.abort()}),"onprogress"in r&&(r.onprogress=d),r.onreadystatechange=function(){function e(){try{f&&t(ie).emit(r.status,(e=r.getAllResponseHeaders(),n={},e&&e.split("\r\n").forEach(function(e){var t=e.indexOf(": ");n[e.substring(0,t)]=e.substring(t+2)}),n)),f=!1}catch(e){}var e,n}switch(r.readyState){case 2:case 3:return e();case 4:e(),2==String(r.status)[0]?(d(),t(ue).emit()):c(de(r.status,r.responseText))}};try{for(var v in r.open(e,n,!0),i)r.setRequestHeader(v,i[v]);(function(t,e){function n(e){return e.port||{"http:":80,"https:":443}[e.protocol||t.protocol]}return!!(e.protocol&&e.protocol!=t.protocol||e.host&&e.host!=t.host||e.host&&n(e)!=n(t))})(p.location,{protocol:(u=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(n)||[])[1]||"",host:u[2]||"",port:u[3]||""})||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=a,r.send(o)}catch(e){p.setTimeout(h(c,de(G,G,e)),0)}}(i,new XMLHttpRequest,e,t,n,r,o),a(i),function(t,n){"use strict";var o,r={};function e(t){return function(e){o=t(o,e)}}for(var i in n)t(i).on(e(n[i]),r);t(ee).on(function(e){var t=A(o),n=z(t),r=O(o);r&&(W(A(r))[n]=e)}),t(te).on(function(){var e=A(o),t=z(e),n=O(o);n&&delete W(A(n))[t]}),t(se).on(function(){for(var e in n)t(e).un(r)})}(i,H(i)),ve(i,$),pe(i,t)}function me(e,t,n,r,o,i,a){return o=o?s.parse(s.stringify(o)):{},r?(x(r)||(r=s.stringify(r),o["Content-Type"]=o["Content-Type"]||"application/json"),o["Content-Length"]=o["Content-Length"]||r.length):r=null,e(n||"GET",(u=t,!1===a&&(-1==u.indexOf("?")?u+="?":u+="&",u+="_="+(new Date).getTime()),u),r,o,i||!1);var u}function ge(e){var t=S("resume","pause","pipe"),n=h(E,t);return e?n(e)||x(e)?me(he,e):me(he,e.url,e.method,e.body,e.headers,e.withCredentials,e.cached):he()}ge.drop=function(){return ge.drop},"object"==typeof ye?be.exports=ge:p.oboe=ge}(function(){try{return window}catch(e){return self}}(),Object,Array,Error,JSON)},{}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u=e("./vnode"),s=e("./is");function r(e,t,n){var r,o,i,a={};if(void 0!==n?(a=t,s.array(n)?r=n:s.primitive(n)?o=n:n&&n.sel&&(r=[n])):void 0!==t&&(s.array(t)?r=t:s.primitive(t)?o=t:t&&t.sel?r=[t]:a=t),s.array(r))for(i=0;i<r.length;++i)s.primitive(r[i])&&(r[i]=u.vnode(void 0,void 0,void 0,r[i],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,n,r){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var o=0;o<n.length;++o){var i=n[o].data;void 0!==i&&e(i,n[o].children,n[o].sel)}}(a,r,e),u.vnode(e,a,r,o,void 0)}n.h=r,n.default=r},{"./is":22,"./vnode":28}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.htmlDomApi={createElement:function(e){return document.createElement(e)},createElementNS:function(e,t){return document.createElementNS(e,t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,n){e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},getTextContent:function(e){return e.textContent},isElement:function(e){return 1===e.nodeType},isText:function(e){return 3===e.nodeType},isComment:function(e){return 8===e.nodeType}},n.default=n.htmlDomApi},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.array=Array.isArray,n.primitive=function(e){return"string"==typeof e||"number"==typeof e}},{}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});function r(e,t){var n,r=t.elm,o=e.data.attrs,i=t.data.attrs;if((o||i)&&o!==i){for(n in o=o||{},i=i||{}){var a=i[n];o[n]!==a&&(!0===a?r.setAttribute(n,""):!1===a?r.removeAttribute(n):120!==n.charCodeAt(0)?r.setAttribute(n,a):58===n.charCodeAt(3)?r.setAttributeNS("http://www.w3.org/XML/1998/namespace",n,a):58===n.charCodeAt(5)?r.setAttributeNS("http://www.w3.org/1999/xlink",n,a):r.setAttribute(n,a))}for(n in o)n in i||r.removeAttribute(n)}}n.attributesModule={create:r,update:r},n.default=n.attributesModule},{}],24:[function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){for(r in a=a||{},i=i||{})a[r]||o.classList.remove(r);for(r in a)(n=a[r])!==i[r]&&o.classList[n?"add":"remove"](r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.classModule={create:r,update:r},n.default=n.classModule},{}],25:[function(e,t,n){"use strict";function c(e,t){var n=e.type,r=t.data.on;r&&r[n]&&function e(t,n,r){if("function"==typeof t)t.call(n,r,n);else if("object"==typeof t)if("function"==typeof t[0])if(2===t.length)t[0].call(n,t[1],r,n);else{var o=t.slice(1);o.push(r),o.push(n),t[0].apply(n,o)}else for(var i=0;i<t.length;i++)e(t[i])}(r[n],t,e)}function r(e,t){var n,r=e.data.on,o=e.listener,i=e.elm,a=t&&t.data.on,u=t&&t.elm;if(r!==a){if(r&&o)if(a)for(n in r)a[n]||i.removeEventListener(n,o,!1);else for(n in r)i.removeEventListener(n,o,!1);if(a){var s=t.listener=e.listener||function e(t){c(t,e.vnode)};if(s.vnode=t,r)for(n in a)r[n]||u.addEventListener(n,s,!1);else for(n in a)u.addEventListener(n,s,!1)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.eventListenersModule={create:r,update:r,destroy:r},n.default=n.eventListenersModule},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var l=e("./vnode"),p=e("./is"),i=e("./htmldomapi");function w(e){return void 0===e}function k(e){return void 0!==e}var P=l.default("",{},[],void 0,void 0);function x(e,t){return e.key===t.key&&e.sel===t.sel}function C(e,t,n){var r,o,i,a={};for(r=t;r<=n;++r)null!=(i=e[r])&&void 0!==(o=i.key)&&(a[o]=r);return a}var a=["create","update","remove","destroy","pre","post"],r=e("./h");n.h=r.h;var o=e("./thunk");n.thunk=o.thunk,n.init=function(e,t){var n,r,v={},h=void 0!==t?t:i.default;for(n=0;n<a.length;++n)for(v[a[n]]=[],r=0;r<e.length;++r){var o=e[r][a[n]];void 0!==o&&v[a[n]].push(o)}function s(t,n){return function(){if(0==--n){var e=h.parentNode(t);h.removeChild(e,t)}}}function m(e,t){var n,r=e.data;void 0!==r&&k(n=r.hook)&&k(n=n.init)&&(n(e),r=e.data);var o=e.children,i=e.sel;if("!"===i)w(e.text)&&(e.text=""),e.elm=h.createComment(e.text);else if(void 0!==i){var a=i.indexOf("#"),u=i.indexOf(".",a),s=0<a?a:i.length,c=0<u?u:i.length,l=-1!==a||-1!==u?i.slice(0,Math.min(s,c)):i,f=e.elm=k(r)&&k(n=r.ns)?h.createElementNS(n,l):h.createElement(l);for(s<c&&f.setAttribute("id",i.slice(s+1,c)),0<u&&f.setAttribute("class",i.slice(c+1).replace(/\./g," ")),n=0;n<v.create.length;++n)v.create[n](P,e);if(p.array(o))for(n=0;n<o.length;++n){var d=o[n];null!=d&&h.appendChild(f,m(d,t))}else p.primitive(e.text)&&h.appendChild(f,h.createTextNode(e.text));k(n=e.data.hook)&&(n.create&&n.create(P,e),n.insert&&t.push(e))}else e.elm=h.createTextNode(e.text);return e.elm}function g(e,t,n,r,o,i){for(;r<=o;++r){var a=n[r];null!=a&&h.insertBefore(e,m(a,i),t)}}function c(e){var t,n,r=e.data;if(void 0!==r){for(k(t=r.hook)&&k(t=t.destroy)&&t(e),t=0;t<v.destroy.length;++t)v.destroy[t](e);if(void 0!==e.children)for(n=0;n<e.children.length;++n)null!=(t=e.children[n])&&"string"!=typeof t&&c(t)}}function b(e,t,n,r){for(;n<=r;++n){var o=void 0,i=void 0,a=void 0,u=t[n];if(null!=u)if(k(u.sel)){for(c(u),i=v.remove.length+1,a=s(u.elm,i),o=0;o<v.remove.length;++o)v.remove[o](u,a);k(o=u.data)&&k(o=o.hook)&&k(o=o.remove)?o(u,a):a()}else h.removeChild(e,u.elm)}}function y(e,t,n){var r,o;k(r=t.data)&&k(o=r.hook)&&k(r=o.prepatch)&&r(e,t);var i=t.elm=e.elm,a=e.children,u=t.children;if(e!==t){if(void 0!==t.data){for(r=0;r<v.update.length;++r)v.update[r](e,t);k(r=t.data.hook)&&k(r=r.update)&&r(e,t)}w(t.text)?k(a)&&k(u)?a!==u&&function(e,t,n,r){for(var o,i,a,u=0,s=0,c=t.length-1,l=t[0],f=t[c],d=n.length-1,v=n[0],p=n[d];u<=c&&s<=d;)null==l?l=t[++u]:null==f?f=t[--c]:null==v?v=n[++s]:null==p?p=n[--d]:x(l,v)?(y(l,v,r),l=t[++u],v=n[++s]):x(f,p)?(y(f,p,r),f=t[--c],p=n[--d]):x(l,p)?(y(l,p,r),h.insertBefore(e,l.elm,h.nextSibling(f.elm)),l=t[++u],p=n[--d]):(x(f,v)?(y(f,v,r),h.insertBefore(e,f.elm,l.elm),f=t[--c]):(void 0===o&&(o=C(t,u,c)),w(i=o[v.key])?h.insertBefore(e,m(v,r),l.elm):(a=t[i]).sel!==v.sel?h.insertBefore(e,m(v,r),l.elm):(y(a,v,r),t[i]=void 0,h.insertBefore(e,a.elm,l.elm))),v=n[++s]);(u<=c||s<=d)&&(c<u?g(e,null==n[d+1]?null:n[d+1].elm,n,s,d,r):b(e,t,u,c))}(i,a,u,n):k(u)?(k(e.text)&&h.setTextContent(i,""),g(i,null,u,0,u.length-1,n)):k(a)?b(i,a,0,a.length-1):k(e.text)&&h.setTextContent(i,""):e.text!==t.text&&h.setTextContent(i,t.text),k(o)&&k(r=o.postpatch)&&r(e,t)}}return function(e,t){var n,r,o,i,a,u,s=[];for(n=0;n<v.pre.length;++n)v.pre[n]();for(void 0===e.sel&&(a=(i=e).id?"#"+i.id:"",u=i.className?"."+i.className.split(" ").join("."):"",e=l.default(h.tagName(i).toLowerCase()+a+u,{},[],void 0,i)),x(e,t)?y(e,t,s):(r=e.elm,o=h.parentNode(r),m(t,s),null!==o&&(h.insertBefore(o,t.elm,h.nextSibling(r)),b(o,[e],0,0))),n=0;n<s.length;++n)s[n].data.hook.insert(s[n]);for(n=0;n<v.post.length;++n)v.post[n]();return t}}},{"./h":20,"./htmldomapi":21,"./is":22,"./thunk":27,"./vnode":28}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./h");function u(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function i(e){var t=e.data;u(t.fn.apply(void 0,t.args),e)}function a(e,t){var n,r=e.data,o=t.data,i=r.args,a=o.args;if(r.fn===o.fn&&i.length===a.length){for(n=0;n<a.length;++n)if(i[n]!==a[n])return void u(o.fn.apply(void 0,a),t);u(e,t)}else u(o.fn.apply(void 0,a),t)}n.thunk=function(e,t,n,r){return void 0===r&&(r=n,n=t,t=void 0),o.h(e,{key:t,hook:{init:i,prepatch:a},fn:n,args:r})},n.default=n.thunk},{"./h":20}],28:[function(e,t,n){"use strict";function r(e,t,n,r,o){return{sel:e,data:t,children:n,text:r,elm:o,key:void 0===t?void 0:t.key}}Object.defineProperty(n,"__esModule",{value:!0}),n.vnode=r,n.default=r},{}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("chess.js"),r=e("./puzzle"),o=function(){function e(e){this.gameAnalysis=e,console.log(e)}return e.prototype.puzzles=function(e){var n=this,t=new i.Chess,r=[];this.gameAnalysis.moves.split(" ").forEach(function(e){r.push(t.fen()),t.move(e)}),t.history({verbose:!0}).forEach(function(e,t){n.gameAnalysis.analysis[t].move=e,n.gameAnalysis.analysis[t].halfMove=t+1,n.gameAnalysis.analysis[t].fen=r[t]});var o=this.gameAnalysis.players.white.user.id==e?"w":"b";return this.gameAnalysis.analysis=this.gameAnalysis.analysis.filter(function(e){return e.judgment}).filter(function(e){return e.move.color==o}),console.log(this.gameAnalysis.analysis),this.gameAnalysis.analysis.map(function(e){return n.toPuzzle(e)})},e.prototype.toPuzzle=function(e){return new r.Puzzle(e.fen,e.move,{from:e.best.substring(0,2),to:e.best.substring(2,4)})},e.prototype.example=function(){return[{id:"LU6oDId7",rated:!1,variant:"standard",players:{white:{user:{id:"copperhead",name:"Copperhead"},rating:1614,analysis:{inaccuracy:4,mistake:1,blunder:1,acpl:37}},black:{user:{id:"tailuge",name:"tailuge"},rating:1611,analysis:{inaccuracy:5,mistake:3,blunder:1,acpl:54}}},winner:"white",opening:{eco:"D10",name:"Slav Defense #2",ply:5},moves:"d4 c6 c4 d5 Nc3 Bf5 Bf4 e6 e3 Bd6 Bg3 Bxg3 hxg3 Nf6 Be2 Ne4 Nf3 Nxc3 bxc3 Nd7 cxd5 exd5 Nh4 Be6 Bd3 Nf6 Qc2 Qa5 Ke2 Ne4 Rhc1 O-O-O Bxe4 dxe4 Qxe4 Bc4+ Kd2 g6 Nf3 f5 Qc2 Bd5 Rcb1 Be4 Qb3 Bxb1 Rxb1 b6 Qe6+ Kb8 Qe5+ Qxe5 Nxe5 c5 Nc6+ Kc7 Nxd8 Rxd8 a4 cxd4 cxd4 Rd5 Rb5 Rxb5 axb5 a6 bxa6 Kb8 Kc3",analysis:[{eval:8},{eval:21},{eval:15},{eval:47},{eval:2},{eval:90,best:"g8f6",variation:"Nf6 cxd5 cxd5 Nf3 Nc6 Bf4 Nh5 Bd2 Nf6 e3",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Nf6."}},{eval:28,best:"d1b3",variation:"Qb3 Qb6 Qxb6 axb6 cxd5 Nf6 dxc6 Nxc6 e3 Nb4",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Qb3."}},{eval:25},{eval:12},{eval:38},{eval:10},{eval:25},{eval:24},{eval:23},{eval:4},{eval:54,best:"d8b6",variation:"Qb6 b3 Qb4 Qd2 O-O f3 h6 g4 Bg6 Nh3 dxc4 bxc4 Nbd7 Kf1",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Qb6."}},{eval:20},{eval:23},{eval:20},{eval:55},{eval:35},{eval:41},{eval:32},{eval:42},{eval:0},{eval:52,best:"g7g6",variation:"g6 Nf3 O-O Kf1 Re8 Rh4 b6 g4 Nf6 Ne5 Nd7 Nf3",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was g6."}},{eval:15},{eval:50},{eval:0,best:"e1g1",variation:"O-O",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was O-O."}},{eval:10},{eval:-6},{eval:96,best:"e4d6",variation:"Nd6 Nf3 Rc8 a4 g6 Nd2 O-O Kf1 Qd8 c4 c5 cxd5 cxd4 Qb2",judgment:{name:"Mistake",comment:"Mistake. Best move was Nd6."}},{eval:50},{eval:41},{eval:54},{eval:53},{eval:-15,best:"e2e1",variation:"Ke1 Kb8 Nf5 Rhg8 f3 Ka8 Kf2 g6 Nh6 Rge8 Qf4 f5 Kg1 a6",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Ke1."}},{eval:0},{eval:-35},{eval:55,best:"h8e8",variation:"Rhe8",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Rhe8."}},{eval:31},{eval:71},{eval:-48,best:"d2e1",variation:"Ke1 c5 Kf1 Qa6+ Kg1 Bxf3 gxf3 h5 Kg2 h4 Rh1 hxg3 fxg3 Qe6",judgment:{name:"Mistake",comment:"Mistake. Best move was Ke1."}},{eval:-36},{eval:-45},{eval:-35},{eval:-46},{eval:20,best:"d8d7",variation:"Rd7 a4 Re8 Ke1 Rc7 Kf1 c5 c4 cxd4 exd4 Qb6 Qc2 Qc6 Ne5",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Rd7."}},{eval:-43,best:"d2e2",variation:"Ke2 Rhe8 Kf1 Kb8 a4 Kb7 Kg1 Ka8 Rc1 Qa6 Ne5 Qb7 Rb1 Rb8",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Ke2."}},{eval:-46},{eval:-48},{eval:-43},{eval:-43},{eval:176,best:"d8c8",variation:"Rc8 Rh1 Kc7 a4 Rce8 c4 Re6 a5 bxa5 Ra1 Ra8 Rxa5 Kb6 Ra1",judgment:{name:"Mistake",comment:"Mistake. Best move was Rc8."}},{eval:169},{eval:174},{eval:177},{eval:176},{eval:161},{eval:177},{eval:145},{eval:153},{eval:148},{eval:314,best:"d5d8",variation:"Rd8 Rb1 Kd6 f3 Rd7 Kd3 Rf7 a5 bxa5 Rb5 Kc6 Rxa5 Kb6 Ra1",judgment:{name:"Mistake",comment:"Mistake. Best move was Rd8."}},{eval:268},{eval:1391,best:"c7d6",variation:"Kd6 Kc3",judgment:{name:"Blunder",comment:"Blunder. Best move was Kd6."}},{eval:1367},{eval:1322},{eval:557,best:"d4d5",variation:"d5 g5 d6 f4 exf4 gxf4 gxf4 h5 a7+ Kxa7 d7 Kb7 d8=Q h4",judgment:{name:"Blunder",comment:"Blunder. Best move was d5."}}],clock:{initial:300,increment:0,totalTime:300}}]},e}();n.Analysis=o},{"./puzzle":33,"chess.js":1}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("snabbdom"),o=e("snabbdom/modules/class"),i=e("snabbdom/modules/attributes"),a=e("snabbdom/modules/eventlisteners"),u=function(){function e(e){this.patch=r.init([o.default,i.default,a.default]),this.puzzles=[],this.element=e}return e.prototype.setPuzzles=function(e){this.puzzles=e,this.redraw()},e.prototype.redraw=function(){this.vnode=this.patch(this.vnode||this.element,this.render(this.puzzles))},e.prototype.render=function(e){var t=e.map(function(e){return r.h("section.blue.merida",[r.h("div.cg-board-wrap",{hook:{insert:e.runUnit,postpatch:e.runUnit}}),r.h("p","Puzzle")])});return r.h("div#chessground-examples",t)},e}();n.Boards=u},{snabbdom:26,"snabbdom/modules/attributes":23,"snabbdom/modules/class":24,"snabbdom/modules/eventlisteners":25}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("oboe"),r=function(){function e(e){this.url=e}return e.prototype.games=function(e,t,n,r){var o=[];i({method:"GET",url:this.url+"/games/export/"+e+"?max="+t+"&analysed=true&evals=true&moves=true&opening=true",headers:{Accept:"application/x-ndjson"}}).node("!",function(e){o.push(e),n(e)}).on("end",function(e){r(o)}).fail(function(e){console.error(JSON.stringify(e))})},e}();n.LichessApi=r},{oboe:19}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./lichessApi");n.LichessApi=r.LichessApi;var o=e("./boards");n.Boards=o.Boards;var i=e("./analysis");n.Analysis=i.Analysis},{"./analysis":29,"./boards":30,"./lichessApi":31}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=e("chess.js"),u=e("chessground"),s=e("./util"),r=function(){function e(e,t,n){var r=this;this.runUnit=function(e){var t=e.elm;t.className="cg-board-wrap",r.run(t)},this.initialFen=e,this.movePlayed=t,this.bestMove=n}return e.prototype.run=function(e){var n=this,r=new a.Chess(this.initialFen),t=s.toColor(r),o={orientation:t,turnColor:t,fen:this.initialFen,movable:{color:t,free:!1,dests:s.toDests(r)}},i=u.Chessground(e,o);return i.set({movable:{events:{after:function(e,t){r.move({from:e,to:t}),i.set({turnColor:s.toColor(r),movable:{color:s.toColor(r),dests:s.toDests(r)},drawable:{shapes:[{orig:n.movePlayed.from,dest:n.movePlayed.to,brush:"red"},{orig:n.bestMove.from,dest:n.bestMove.to,brush:"green"}]}})}}},drawable:{shapes:[{orig:this.movePlayed.from,dest:this.movePlayed.to,brush:"red"}]},events:{select:function(e){i.set({drawable:{shapes:[{orig:n.movePlayed.from,dest:n.movePlayed.to,brush:"red"},{orig:e,brush:"blue"}]}})}}}),i},e}();n.Puzzle=r},{"./util":34,"chess.js":1,chessground:5}],34:[function(e,t,n){"use strict";function o(n){var r={};return n.SQUARES.forEach(function(e){var t=n.moves({square:e,verbose:!0});t.length&&(r[e]=t.map(function(e){return e.to}))}),r}function i(e){return"w"===e.turn()?"white":"black"}Object.defineProperty(n,"__esModule",{value:!0}),n.toDests=o,n.toColor=i,n.playOtherSide=function(n,r){return function(e,t){r.move({from:e,to:t}),n.set({turnColor:i(r),movable:{color:i(r),dests:o(r)}})}}},{}]},{},[32])(32)});