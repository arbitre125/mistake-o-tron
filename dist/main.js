!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ChessgroundExamples=e()}}(function(){return function i(a,s,l){function c(r,e){if(!s[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(u)return u(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[r]={exports:{}};a[r][0].call(o.exports,function(e){var t=a[r][1][e];return c(t||e)},o,o.exports,i,a,s,l)}return s[r].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,r){var n=function(e){var c="b",u="w",l=-1,y="p",w="n",k="b",x="r",P="q",f="k",n="pnbrqkPNBRQK",t="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",v=["1-0","0-1","1/2-1/2","*"],E={b:[16,32,17,15],w:[-16,-32,-17,-15]},C={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},d=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],p=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],h={p:0,n:1,b:2,r:3,q:4,k:5},o={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},_={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},A=7,O=6,T=1,N=0,S={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m={w:[{square:S.a1,flag:_.QSIDE_CASTLE},{square:S.h1,flag:_.KSIDE_CASTLE}],b:[{square:S.a8,flag:_.QSIDE_CASTLE},{square:S.h8,flag:_.KSIDE_CASTLE}]},R=new Array(128),K={w:l,b:l},M=u,L={w:0,b:0},j=l,g=0,b=1,I=[],B={};function s(){R=new Array(128),K={w:l,b:l},M=u,L={w:0,b:0},j=l,g=0,b=1,I=[],B={},$(U())}function D(){q(t)}function q(e){var t=e.split(/\s+/),r=t[0],n=0;if(!Q(e).valid)return!1;s();for(var o=0;o<r.length;o++){var i=r.charAt(o);if("/"===i)n+=8;else if(-1!=="0123456789".indexOf(i))n+=parseInt(i,10);else{var a=i<"a"?u:c;F({type:i.toLowerCase(),color:a},ae(n)),n++}}return M=t[1],-1<t[2].indexOf("K")&&(L.w|=_.KSIDE_CASTLE),-1<t[2].indexOf("Q")&&(L.w|=_.QSIDE_CASTLE),-1<t[2].indexOf("k")&&(L.b|=_.KSIDE_CASTLE),-1<t[2].indexOf("q")&&(L.b|=_.QSIDE_CASTLE),j="-"===t[3]?l:S[t[3]],g=parseInt(t[4],10),b=parseInt(t[5],10),$(U()),!0}function Q(e){var t="No errors.",r="FEN string must contain six space-delimited fields.",n="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",s="2nd field (side to move) is invalid.",l="1st field (piece positions) does not contain 8 '/'-delimited rows.",c="1st field (piece positions) is invalid [consecutive numbers].",u="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",d="Illegal en-passant square",p=e.split(/\s+/);if(6!==p.length)return{valid:!1,error_number:1,error:r};if(isNaN(p[5])||parseInt(p[5],10)<=0)return{valid:!1,error_number:2,error:n};if(isNaN(p[4])||parseInt(p[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(p[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(p[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(p[1]))return{valid:!1,error_number:6,error:s};var v=p[0].split("/");if(8!==v.length)return{valid:!1,error_number:7,error:l};for(var h=0;h<v.length;h++){for(var m=0,g=!1,b=0;b<v[h].length;b++)if(isNaN(v[h][b])){if(!/^[prnbqkPRNBQK]$/.test(v[h][b]))return{valid:!1,error_number:9,error:u};m+=1,g=!1}else{if(g)return{valid:!1,error_number:8,error:c};m+=parseInt(v[h][b],10),g=!0}if(8!==m)return{valid:!1,error_number:10,error:f}}return"3"==p[3][1]&&"w"==p[1]||"6"==p[3][1]&&"b"==p[1]?{valid:!1,error_number:11,error:d}:{valid:!0,error_number:0,error:t}}function U(){for(var e=0,t="",r=S.a8;r<=S.h1;r++){if(null==R[r])e++;else{0<e&&(t+=e,e=0);var n=R[r].color,o=R[r].type;t+=n===u?o.toUpperCase():o.toLowerCase()}r+1&136&&(0<e&&(t+=e),r!==S.h1&&(t+="/"),e=0,r+=8)}var i="";L[u]&_.KSIDE_CASTLE&&(i+="K"),L[u]&_.QSIDE_CASTLE&&(i+="Q"),L[c]&_.KSIDE_CASTLE&&(i+="k"),L[c]&_.QSIDE_CASTLE&&(i+="q"),i=i||"-";var a=j===l?"-":ae(j);return[t,M,i,a,g,b].join(" ")}function z(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(B[e[t]]=e[t+1]);return B}function $(e){0<I.length||(e!==t?(B.SetUp="1",B.FEN=e):(delete B.SetUp,delete B.FEN))}function i(e){var t=R[S[e]];return t?{type:t.type,color:t.color}:null}function F(e,t){if(!("type"in e&&"color"in e))return!1;if(-1===n.indexOf(e.type.toLowerCase()))return!1;if(!(t in S))return!1;var r=S[t];return(e.type!=f||K[e.color]==l||K[e.color]==r)&&(R[r]={type:e.type,color:e.color},e.type===f&&(K[e.color]=r),$(U()),!0)}function W(e,t,r,n,o){var i={color:M,from:t,to:r,flags:n,piece:e[t].type};return o&&(i.flags|=_.PROMOTION,i.promotion=o),e[r]?i.captured=e[r].type:n&_.EP_CAPTURE&&(i.captured=y),i}function G(e){function t(e,t,r,n,o){if(e[r].type!==y||oe(n)!==N&&oe(n)!==A)t.push(W(e,r,n,o));else for(var i=[P,x,k,w],a=0,s=i.length;a<s;a++)t.push(W(e,r,n,o,i[a]))}var r=[],n=M,o=se(n),i={b:T,w:O},a=S.a8,s=S.h1,l=!1,c=!(void 0!==e&&"legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in S))return[];a=s=S[e.square],l=!0}for(var u=a;u<=s;u++)if(136&u)u+=7;else{var f=R[u];if(null!=f&&f.color===n)if(f.type===y){var d=u+E[n][0];if(null==R[d]){t(R,r,u,d,_.NORMAL);d=u+E[n][1];i[n]===oe(u)&&null==R[d]&&t(R,r,u,d,_.BIG_PAWN)}for(p=2;p<4;p++){136&(d=u+E[n][p])||(null!=R[d]&&R[d].color===o?t(R,r,u,d,_.CAPTURE):d===j&&t(R,r,u,j,_.EP_CAPTURE))}}else for(var p=0,v=C[f.type].length;p<v;p++){var h=C[f.type][p];for(d=u;!(136&(d+=h));){if(null!=R[d]){if(R[d].color===n)break;t(R,r,u,d,_.CAPTURE);break}if(t(R,r,u,d,_.NORMAL),"n"===f.type||"k"===f.type)break}}}if(!l||s===K[n]){if(L[n]&_.KSIDE_CASTLE){var m=(g=K[n])+2;null!=R[g+1]||null!=R[m]||Z(o,K[n])||Z(o,g+1)||Z(o,m)||t(R,r,K[n],m,_.KSIDE_CASTLE)}if(L[n]&_.QSIDE_CASTLE){var g;m=(g=K[n])-2;null!=R[g-1]||null!=R[g-2]||null!=R[g-3]||Z(o,K[n])||Z(o,g-1)||Z(o,m)||t(R,r,K[n],m,_.QSIDE_CASTLE)}}if(!c)return r;var b=[];for(u=0,v=r.length;u<v;u++)te(r[u]),V(n)||b.push(r[u]),re();return b}function H(e,t){var r="";if(e.flags&_.KSIDE_CASTLE)r="O-O";else if(e.flags&_.QSIDE_CASTLE)r="O-O-O";else{var n=function(e,t){for(var r=G({legal:!t}),n=e.from,o=e.to,i=e.piece,a=0,s=0,l=0,c=0,u=r.length;c<u;c++){var f=r[c].from,d=r[c].to,p=r[c].piece;i===p&&n!==f&&o===d&&(a++,oe(n)===oe(f)&&s++,ie(n)===ie(f)&&l++)}if(0<a)return 0<s&&0<l?ae(n):0<l?ae(n).charAt(1):ae(n).charAt(0);return""}(e,t);e.piece!==y&&(r+=e.piece.toUpperCase()+n),e.flags&(_.CAPTURE|_.EP_CAPTURE)&&(e.piece===y&&(r+=ae(e.from)[0]),r+="x"),r+=ae(e.to),e.flags&_.PROMOTION&&(r+="="+e.promotion.toUpperCase())}return te(e),a()&&(Y()?r+="#":r+="+"),re(),r}function X(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Z(e,t){for(var r=S.a8;r<=S.h1;r++)if(136&r)r+=7;else if(null!=R[r]&&R[r].color===e){var n=R[r],o=r-t,i=o+119;if(d[i]&1<<h[n.type]){if(n.type===y){if(0<o){if(n.color===u)return!0}else if(n.color===c)return!0;continue}if("n"===n.type||"k"===n.type)return!0;for(var a=p[i],s=r+a,l=!1;s!==t;){if(null!=R[s]){l=!0;break}s+=a}if(!l)return!0}}return!1}function V(e){return Z(se(e),K[e])}function a(){return V(M)}function Y(){return a()&&0===G().length}function r(){return!a()&&0===G().length}function J(){for(var e={},t=[],r=0,n=0,o=S.a8;o<=S.h1;o++)if(n=(n+1)%2,136&o)o+=7;else{var i=R[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===k&&t.push(n),r++)}if(2===r)return!0;if(3===r&&(1===e[k]||1===e[w]))return!0;if(r===e[k]+2){var a=0,s=t.length;for(o=0;o<s;o++)a+=t[o];if(0===a||a===s)return!0}return!1}function ee(){for(var e=[],t={},r=!1;;){var n=re();if(!n)break;e.push(n)}for(;;){var o=U().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,3<=t[o]&&(r=!0),!e.length)break;te(e.pop())}return r}function te(e){var t,r=M,n=se(r);if(t=e,I.push({move:t,kings:{b:K.b,w:K.w},turn:M,castling:{b:L.b,w:L.w},ep_square:j,half_moves:g,move_number:b}),R[e.to]=R[e.from],R[e.from]=null,e.flags&_.EP_CAPTURE&&(M===c?R[e.to-16]=null:R[e.to+16]=null),e.flags&_.PROMOTION&&(R[e.to]={type:e.promotion,color:r}),R[e.to].type===f){if(K[R[e.to].color]=e.to,e.flags&_.KSIDE_CASTLE){var o=e.to-1,i=e.to+1;R[o]=R[i],R[i]=null}else if(e.flags&_.QSIDE_CASTLE){o=e.to+1,i=e.to-2;R[o]=R[i],R[i]=null}L[r]=""}if(L[r])for(var a=0,s=m[r].length;a<s;a++)if(e.from===m[r][a].square&&L[r]&m[r][a].flag){L[r]^=m[r][a].flag;break}if(L[n])for(a=0,s=m[n].length;a<s;a++)if(e.to===m[n][a].square&&L[n]&m[n][a].flag){L[n]^=m[n][a].flag;break}j=e.flags&_.BIG_PAWN?"b"===M?e.to-16:e.to+16:l,e.piece===y?g=0:e.flags&(_.CAPTURE|_.EP_CAPTURE)?g=0:g++,M===c&&b++,M=se(M)}function re(){var e=I.pop();if(null==e)return null;var t=e.move;K=e.kings,M=e.turn,L=e.castling,j=e.ep_square,g=e.half_moves,b=e.move_number;var r,n,o=M,i=se(M);if(R[t.from]=R[t.to],R[t.from].type=t.piece,R[t.to]=null,t.flags&_.CAPTURE)R[t.to]={type:t.captured,color:i};else if(t.flags&_.EP_CAPTURE){var a;a=o===c?t.to-16:t.to+16,R[a]={type:y,color:i}}t.flags&(_.KSIDE_CASTLE|_.QSIDE_CASTLE)&&(t.flags&_.KSIDE_CASTLE?(r=t.to+1,n=t.to-1):t.flags&_.QSIDE_CASTLE&&(r=t.to-2,n=t.to+1),R[r]=R[n],R[n]=null);return t}function ne(e,t){var r=X(e);if(t){var n=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(n)var o=n[1],i=n[2],a=n[3],s=n[4]}for(var l=G(),c=0,u=l.length;c<u;c++){if(r===X(H(l[c]))||t&&r===X(H(l[c],!0)))return l[c];if(n&&(!o||o.toLowerCase()==l[c].piece)&&S[i]==l[c].from&&S[a]==l[c].to&&(!s||s.toLowerCase()==l[c].promotion))return l[c]}return null}function oe(e){return e>>4}function ie(e){return 15&e}function ae(e){var t=ie(e),r=oe(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function se(e){return e===u?c:u}function le(e){var t=function e(t){var r=t instanceof Array?[]:{};for(var n in t)r[n]="object"==typeof n?e(t[n]):t[n];return r}(e);t.san=H(t,!1),t.to=ae(t.to),t.from=ae(t.from);var r="";for(var n in _)_[n]&t.flags&&(r+=o[n]);return t.flags=r,t}function ce(e){return e.replace(/^\s+|\s+$/g,"")}return q(void 0===e?t:e),{WHITE:u,BLACK:c,PAWN:y,KNIGHT:w,BISHOP:k,ROOK:x,QUEEN:P,KING:f,SQUARES:function(){for(var e=[],t=S.a8;t<=S.h1;t++)136&t?t+=7:e.push(ae(t));return e}(),FLAGS:o,load:function(e){return q(e)},reset:function(){return D()},moves:function(e){for(var t=G(e),r=[],n=0,o=t.length;n<o;n++)void 0!==e&&"verbose"in e&&e.verbose?r.push(le(t[n])):r.push(H(t[n],!1));return r},in_check:function(){return a()},in_checkmate:function(){return Y()},in_stalemate:function(){return r()},in_draw:function(){return 100<=g||r()||J()||ee()},insufficient_material:function(){return J()},in_threefold_repetition:function(){return ee()},game_over:function(){return 100<=g||Y()||r()||J()||ee()},validate_fen:function(e){return Q(e)},fen:function(){return U()},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",r="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,n=[],o=!1;for(var i in B)n.push("["+i+' "'+B[i]+'"]'+t),o=!0;o&&I.length&&n.push(t);for(var a=[];0<I.length;)a.push(re());for(var s=[],l="";0<a.length;){var c=a.pop();I.length||"b"!==c.color?"w"===c.color&&(l.length&&s.push(l),l=b+"."):l=b+". ...",l=l+" "+H(c,!1),te(c)}if(l.length&&s.push(l),void 0!==B.Result&&s.push(B.Result),0===r)return n.join("")+s.join(" ");var u=0;for(i=0;i<s.length;i++)u+s[i].length>r&&0!==i?(" "===n[n.length-1]&&n.pop(),n.push(t),u=0):0!==i&&(n.push(" "),u++),n.push(s[i]),u+=s[i].length;return n.join("")},load_pgn:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy;function l(e){return e.replace(/\\/g,"\\")}var n="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",o=new RegExp("^(\\[(.|"+l(n)+")*\\])("+l(n)+")*1.("+l(n)+"|.)*$","g"),i=e.replace(o,"$1");"["!==i[0]&&(i=""),D();var a=function(e,t){for(var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",n={},o=e.split(new RegExp(l(r))),i="",a="",s=0;s<o.length;s++)i=o[s].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),a=o[s].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),0<ce(i).length&&(n[i]=a);return n}(i,t);for(var s in a)z([s,a[s]]);if("1"===a.SetUp&&!("FEN"in a&&q(a.FEN)))return!1;var c=e.replace(i,"").replace(new RegExp(l(n),"g")," ");c=c.replace(/(\{[^}]+\})+?/g,"");for(var u=/(\([^\(\)]+\))+?/g;u.test(c);)c=c.replace(u,"");var f=ce(c=(c=(c=c.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));f=f.join(",").replace(/,,+/g,",").split(",");for(var d="",p=0;p<f.length-1;p++){if(null==(d=ne(f[p],r)))return!1;te(d)}if(d=f[f.length-1],-1<v.indexOf(d))(function(e){for(var t in e)return!0;return!1})(B)&&void 0===B.Result&&z(["Result",d]);else{if(null==(d=ne(d,r)))return!1;te(d)}return!0},header:function(){return z(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",t=S.a8;t<=S.h1;t++){if(0===ie(t)&&(e+=" "+"87654321"[oe(t)]+" |"),null==R[t])e+=" . ";else{var r=R[t].type;e+=" "+(R[t].color===u?r.toUpperCase():r.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return M},move:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy,n=null;if("string"==typeof e)n=ne(e,r);else if("object"==typeof e)for(var o=G(),i=0,a=o.length;i<a;i++)if(!(e.from!==ae(o[i].from)||e.to!==ae(o[i].to)||"promotion"in o[i]&&e.promotion!==o[i].promotion)){n=o[i];break}if(!n)return null;var s=le(n);return te(n),s},undo:function(){var e=re();return e?le(e):null},clear:function(){return s()},put:function(e,t){return F(e,t)},get:function(e){return i(e)},remove:function(e){return r=i(t=e),R[S[t]]=null,r&&r.type===f&&(K[r.color]=l),$(U()),r;var t,r},perft:function(e){return function e(t){for(var r=G({legal:!1}),n=0,o=M,i=0,a=r.length;i<a;i++)te(r[i]),V(o)||(0<t-1?n+=e(t-1):n++),re();return n}(e)},square_color:function(e){if(e in S){var t=S[e];return(oe(t)+ie(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],r=[],n=(void 0!==e&&"verbose"in e&&e.verbose);0<I.length;)t.push(re());for(;0<t.length;){var o=t.pop();n?r.push(le(o)):r.push(H(o)),te(o)}return r}}};void 0!==r&&(r.Chess=n)},{}],2:[function(e,t,r){"use strict";var a=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(r,"__esModule",{value:!0});var h=e("./util");function n(e,t){var r=e(t);return t.dom.redraw(),r}function m(e,t){return{key:e,pos:h.key2pos(e),piece:t}}r.anim=function(e,t){return t.animation.enabled?function(e,t){var r=a({},t.pieces),n=e(t),o=function(e,t){var r,n,o,i,a={},s=[],l={},c=[],u=[],f={};for(o in e)f[o]=m(o,e[o]);for(var d=0,p=h.allKeys;d<p.length;d++){var v=p[d];r=t.pieces[v],n=f[v],r?n?h.samePiece(r,n.piece)||(c.push(n),u.push(m(v,r))):u.push(m(v,r)):n&&c.push(n)}return u.forEach(function(t){var r,e;r=t,e=c.filter(function(e){return h.samePiece(t.piece,e.piece)}),(n=e.sort(function(e,t){return h.distanceSq(r.pos,e.pos)-h.distanceSq(r.pos,t.pos)})[0])&&(i=[n.pos[0]-t.pos[0],n.pos[1]-t.pos[1]],a[t.key]=i.concat(i),s.push(n.key))}),c.forEach(function(e){h.containsX(s,e.key)||t.items&&t.items(e.pos,e.key)||(l[e.key]=e.piece)}),{anims:a,fadings:l}}(r,t);if(s(o.anims)&&s(o.fadings))t.dom.redraw();else{var i=t.animation.current&&t.animation.current.start;t.animation.current={start:c.now(),frequency:1/t.animation.duration,plan:o},i||function t(r,e){var n=r.animation.current;if(void 0!==n){var o,i=1-(e-n.start)*n.frequency;if(i<=0)r.animation.current=void 0,r.dom.redrawNow();else{var a=(o=i)<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1;for(var s in n.plan.anims){var l=n.plan.anims[s];l[2]=l[0]*a,l[3]=l[1]*a}r.dom.redrawNow(!0),h.raf(function(e){return void 0===e&&(e=c.now()),t(r,e)})}}else r.dom.destroyed||r.dom.redrawNow()}(t,c.now())}return n}(e,t):n(e,t)},r.render=n;var c=void 0!==window.performance?window.performance:Date;function s(e){for(var t in e)return!1;return!0}},{"./util":17}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./board"),i=e("./fen"),a=e("./config"),s=e("./anim"),l=e("./drag"),c=e("./explosion");r.start=function(n,e){function r(){o.toggleOrientation(n),e()}return{set:function(t){t.orientation&&t.orientation!==n.orientation&&r(),(t.fen?s.anim:s.render)(function(e){return a.configure(e,t)},n)},state:n,getFen:function(){return i.write(n.pieces)},toggleOrientation:r,setPieces:function(t){s.anim(function(e){return o.setPieces(e,t)},n)},selectSquare:function(t,r){t?s.anim(function(e){return o.selectSquare(e,t,r)},n):n.selected&&(o.unselect(n),n.dom.redraw())},move:function(t,r){s.anim(function(e){return o.baseMove(e,t,r)},n)},newPiece:function(t,r){s.anim(function(e){return o.baseNewPiece(e,t,r)},n)},playPremove:function(){if(n.premovable.current){if(s.anim(o.playPremove,n))return!0;n.dom.redraw()}return!1},playPredrop:function(e){if(n.predroppable.current){var t=o.playPredrop(n,e);return n.dom.redraw(),t}return!1},cancelPremove:function(){s.render(o.unsetPremove,n)},cancelPredrop:function(){s.render(o.unsetPredrop,n)},cancelMove:function(){s.render(function(e){o.cancelMove(e),l.cancel(e)},n)},stop:function(){s.render(function(e){o.stop(e),l.cancel(e)},n)},explode:function(e){c.default(n,e)},setAutoShapes:function(t){s.render(function(e){return e.drawable.autoShapes=t},n)},setShapes:function(t){s.render(function(e){return e.drawable.shapes=t},n)},getKeyAtDomPos:function(e){return o.getKeyAtDomPos(e,"white"===n.orientation,n.dom.bounds())},redrawAll:e,dragNewPiece:function(e,t,r){l.dragNewPiece(n,e,t,r)},destroy:function(){o.stop(n),n.dom.unbind&&n.dom.unbind(),n.dom.destroyed=!0}}}},{"./anim":2,"./board":4,"./config":6,"./drag":7,"./explosion":10,"./fen":11}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=e("./util"),v=e("./premove");function m(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function g(e){e.premovable.current&&(e.premovable.current=void 0,m(e.premovable.events.unset))}function b(e){var t=e.predroppable;t.current&&(t.current=void 0,m(t.events.unset))}function o(e,t,r){if(t===r||!e.pieces[t])return!1;var n=e.pieces[r]&&e.pieces[r].color!==e.pieces[t].color?e.pieces[r]:void 0;return r==e.selected&&k(e),m(e.events.move,t,r,n),function(e,t,r){if(!e.autoCastle)return!1;var n=e.pieces[t];if("king"!==n.role)return!1;var o=p.key2pos(t);if(5!==o[0])return!1;if(1!==o[1]&&8!==o[1])return!1;var i,a,s,l=p.key2pos(r);if(7===l[0]||8===l[0])i=p.pos2key([8,o[1]]),a=p.pos2key([6,o[1]]),s=p.pos2key([7,o[1]]);else{if(3!==l[0]&&1!==l[0])return!1;i=p.pos2key([1,o[1]]),a=p.pos2key([4,o[1]]),s=p.pos2key([3,o[1]])}var c=e.pieces[i];return"rook"===c.role&&(delete e.pieces[t],delete e.pieces[i],e.pieces[s]=n,e.pieces[a]=c,!0)}(e,t,r)||(e.pieces[r]=e.pieces[t],delete e.pieces[t]),e.lastMove=[t,r],e.check=void 0,m(e.events.change),n||!0}function y(e,t,r,n){if(e.pieces[r]){if(!n)return!1;delete e.pieces[r]}return m(e.events.dropNewPiece,t,r),e.pieces[r]=t,e.lastMove=[r],e.check=void 0,m(e.events.change),e.movable.dests=void 0,e.turnColor=p.opposite(e.turnColor),!0}function h(e,t,r){var n=o(e,t,r);return n&&(e.movable.dests=void 0,e.turnColor=p.opposite(e.turnColor),e.animation.current=void 0),n}function n(e,t,r){if(P(e,t,r)){var n=h(e,t,r);if(n){var o=e.hold.stop();k(e);var i={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return!0!==n&&(i.captured=n),m(e.movable.events.after,t,r,i),!0}}else u=e,(f=t)!==(d=r)&&E(u,f)&&p.containsX(v.default(u.pieces,f,u.premovable.castle),d)?(s=t,l=r,c={ctrlKey:(a=e).stats.ctrlKey},b(a),a.premovable.current=[s,l],m(a.premovable.events.set,s,l,c),k(e)):x(e,r)||E(e,r)?(w(e,r),e.hold.start()):k(e);var a,s,l,c,u,f,d;return!1}function w(e,t){e.selected=t,E(e,t)?e.premovable.dests=v.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function k(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function x(e,t){var r=e.pieces[t];return r&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function P(e,t,r){return t!==r&&x(e,t)&&(e.movable.free||!!e.movable.dests&&p.containsX(e.movable.dests[t],r))}function E(e,t){var r=e.pieces[t];return r&&e.premovable.enabled&&e.movable.color===r.color&&e.turnColor!==r.color}function i(e){g(e),b(e),k(e)}r.callUserFunction=m,r.toggleOrientation=function(e){e.orientation=p.opposite(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0},r.reset=function(e){e.lastMove=void 0,k(e),g(e),b(e)},r.setPieces=function(e,t){for(var r in t){var n=t[r];n?e.pieces[r]=n:delete e.pieces[r]}},r.setCheck=function(e,t){if(!0===t&&(t=e.turnColor),t)for(var r in e.pieces)"king"===e.pieces[r].role&&e.pieces[r].color===t&&(e.check=r);else e.check=void 0},r.unsetPremove=g,r.unsetPredrop=b,r.baseMove=o,r.baseNewPiece=y,r.userMove=n,r.dropNewPiece=function(e,t,r,n){if(p=t,v=r,(h=(d=e).pieces[p])&&v&&(p===v||!d.pieces[v])&&("both"===d.movable.color||d.movable.color===h.color&&d.turnColor===h.color)||n){var o=e.pieces[t];delete e.pieces[t],y(e,o,r,n),m(e.movable.events.afterNewPiece,o.role,r,{predrop:!1})}else c=t,u=r,(f=(l=e).pieces[c])&&u&&(!l.pieces[u]||l.pieces[u].color!==l.movable.color)&&l.predroppable.enabled&&("pawn"!==f.role||"1"!==u[1]&&"8"!==u[1])&&l.movable.color===f.color&&l.turnColor!==f.color?(a=(i=e).pieces[t].role,s=r,g(i),i.predroppable.current={role:a,key:s},m(i.predroppable.events.set,a,s)):(g(e),b(e));var i,a,s,l,c,u,f,d,p,v,h;delete e.pieces[t],k(e)},r.selectSquare=function(e,t,r){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||r)&&e.selected!==t?n(e,e.selected,t)&&(e.stats.dragged=!1):e.hold.start():(k(e),e.hold.cancel()):(x(e,t)||E(e,t))&&(w(e,t),e.hold.start()),m(e.events.select,t)},r.setSelected=w,r.unselect=k,r.canMove=P,r.isDraggable=function(e,t){var r=e.pieces[t];return r&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===r.color&&(e.turnColor===r.color||e.premovable.enabled))},r.playPremove=function(e){var t=e.premovable.current;if(!t)return!1;var r=t[0],n=t[1],o=!1;if(P(e,r,n)){var i=h(e,r,n);if(i){var a={premove:!0};!0!==i&&(a.captured=i),m(e.movable.events.after,r,n,a),o=!0}}return g(e),o},r.playPredrop=function(e,t){var r=e.predroppable.current,n=!1;return!!r&&(t(r)&&y(e,{role:r.role,color:e.movable.color},r.key)&&(m(e.movable.events.afterNewPiece,r.role,r.key,{predrop:!0}),n=!0),b(e),n)},r.cancelMove=i,r.stop=function(e){e.movable.color=e.movable.dests=e.animation.current=void 0,i(e)},r.getKeyAtDomPos=function(e,t,r){var n=Math.ceil((e[0]-r.left)/r.width*8);t||(n=9-n);var o=Math.ceil(8-(e[1]-r.top)/r.height*8);return t||(o=9-o),0<n&&n<9&&0<o&&o<9?p.pos2key([n,o]):void 0}},{"./premove":12,"./util":17}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./api"),o=e("./config"),i=e("./state"),u=e("./wrap"),f=e("./events"),d=e("./render"),p=e("./svg"),v=e("./util");r.Chessground=function(s,e){var l=i.defaults();function c(){var e=l.dom&&l.dom.unbind;s.classList.add("cg-board-wrap");var t,r,n=v.memo(function(){return s.getBoundingClientRect()}),o=l.viewOnly&&!l.drawable.visible,i=u.default(s,l,o?void 0:n()),a=function(e){d.default(l),!e&&i.svg&&p.renderSvg(l,i.svg)};l.dom={elements:i,bounds:n,redraw:(t=a,r=!1,function(){r||(r=!0,v.raf(function(){t(),r=!1}))}),redrawNow:a,unbind:e,relative:o},l.drawable.prevSvgHash="",a(!1),f.bindBoard(l),e||(l.dom.unbind=f.bindDocument(l,c))}return o.configure(l,e||{}),c(),n.start(l,c)}},{"./api":3,"./config":6,"./events":9,"./render":13,"./state":14,"./svg":15,"./util":17,"./wrap":18}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./board"),a=e("./fen");function s(e){return"object"==typeof e}r.configure=function(e,t){if(t.movable&&t.movable.dests&&(e.movable.dests=void 0),function e(t,r){for(var n in r)s(t[n])&&s(r[n])?e(t[n],r[n]):t[n]=r[n]}(e,t),t.fen&&(e.pieces=a.read(t.fen),e.drawable.shapes=[]),t.hasOwnProperty("check")&&i.setCheck(e,t.check||!1),t.hasOwnProperty("lastMove")&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&i.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){var r="white"===e.movable.color?1:8,n="e"+r,o=e.movable.dests[n];if(!o||"king"!==e.pieces[n].role)return;e.movable.dests[n]=o.filter(function(e){return!(e==="a"+r&&-1!==o.indexOf("c"+r)||e==="h"+r&&-1!==o.indexOf("g"+r))})}}},{"./board":4,"./fen":11}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var v=e("./board"),h=e("./util"),m=e("./draw"),g=e("./anim");function b(a){h.raf(function(){var e=a.draggable.current;if(e){a.animation.current&&a.animation.current.plan.anims[e.orig]&&(a.animation.current=void 0);var t=a.pieces[e.orig];if(t&&h.samePiece(t,e.piece)){if(!e.started&&h.distanceSq(e.epos,e.rel)>=Math.pow(a.draggable.distance,2)&&(e.started=!0),e.started){if("function"==typeof e.element){var r=e.element();if(!r)return;e.element=r,e.element.cgDragging=!0,e.element.classList.add("dragging")}var n="white"===a.orientation,o=a.dom.bounds();e.pos=[e.epos[0]-e.rel[0],e.epos[1]-e.rel[1]];var i=h.posToTranslateAbs(o)(e.origPos,n);i[0]+=e.pos[0]+e.dec[0],i[1]+=e.pos[1]+e.dec[1],h.translateAbs(e.element,i)}}else s(a);b(a)}})}function s(e){var t=e.draggable.current;t&&(t.newPiece&&delete e.pieces[t.orig],e.draggable.current=void 0,v.unselect(e),i(e),e.dom.redraw())}function i(e){var t=e.dom.elements;t.ghost&&h.setVisible(t.ghost,!1)}function y(e,t,r){var n=h.key2pos(e);return t||(n[0]=9-n[0],n[1]=9-n[1]),{left:r.left+r.width*(n[0]-1)/8,top:r.top+r.height*(8-n[1])/8,width:r.width/8,height:r.height/8}}function w(e,t){for(var r=e.dom.elements.board.firstChild;r;){if(r.cgKey===t&&"PIECE"===r.tagName)return r;r=r.nextSibling}}r.start=function(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&1<t.touches.length)){t.preventDefault();var r="white"===e.orientation,n=e.dom.bounds(),o=h.eventPosition(t),i=v.getKeyAtDomPos(o,r,n);if(i){var a=e.pieces[i],s=e.selected;s||!e.drawable.enabled||!e.drawable.eraseOnClick&&a&&a.color===e.turnColor||m.clear(e);var l=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&v.canMove(e,e.selected,i)?g.anim(function(e){return v.selectSquare(e,i)},e):v.selectSquare(e,i);var u=e.selected===i,f=w(e,i);if(a&&f&&u&&v.isDraggable(e,i)){var d=y(i,r,n);e.draggable.current={orig:i,origPos:h.key2pos(i),piece:a,rel:o,epos:o,pos:[0,0],dec:e.draggable.centerPiece?[o[0]-(d.left+d.width/2),o[1]-(d.top+d.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:f,previouslySelected:s,originTarget:t.target},f.cgDragging=!0,f.classList.add("dragging");var p=e.dom.elements.ghost;p&&(p.className="ghost "+a.color+" "+a.role,h.translateAbs(p,h.posToTranslateAbs(n)(h.key2pos(i),r)),h.setVisible(p,!0)),b(e)}else l&&v.unsetPremove(e),c&&v.unsetPredrop(e);e.dom.redraw()}}},r.dragNewPiece=function(e,t,r,n){var o="a0";e.pieces.a0=t,e.dom.redraw();var i=h.eventPosition(r),a="white"===e.orientation,s=e.dom.bounds(),l=y(o,a,s),c=[(a?0:7)*l.width+s.left,(a?8:-1)*l.height+s.top];e.draggable.current={orig:o,origPos:h.key2pos(o),piece:t,rel:c,epos:i,pos:[i[0]-c[0],i[1]-c[1]],dec:[-l.width/2,-l.height/2],started:!0,element:function(){return w(e,o)},originTarget:r.target,newPiece:!0,force:n||!1},b(e)},r.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=h.eventPosition(t))},r.end=function(e,t){var r=e.draggable.current;if(r)if("touchend"!==t.type||!r||r.originTarget===t.target||r.newPiece){v.unsetPremove(e),v.unsetPredrop(e);var n=h.eventPosition(t)||r.epos,o=v.getKeyAtDomPos(n,"white"===e.orientation,e.dom.bounds());o&&r.started?r.newPiece?v.dropNewPiece(e,r.orig,o,r.force):(e.stats.ctrlKey=t.ctrlKey,v.userMove(e,r.orig,o)&&(e.stats.dragged=!0)):r.newPiece?delete e.pieces[r.orig]:e.draggable.deleteOnDropOff&&(delete e.pieces[r.orig],v.callUserFunction(e.events.change)),(!r||r.orig!==r.previouslySelected||r.orig!==o&&o)&&e.selectable.enabled||v.unselect(e),i(e),e.draggable.current=void 0,e.dom.redraw()}else e.draggable.current=void 0},r.cancel=s},{"./anim":2,"./board":4,"./draw":8,"./util":17}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("./board"),l=e("./util"),c=["green","red","blue","yellow"];function u(r){l.raf(function(){var e=r.drawable.current;if(e){var t=s.getKeyAtDomPos(e.pos,"white"===r.orientation,r.dom.bounds());t!==e.mouseSq&&(e.mouseSq=t,e.dest=t!==e.orig?t:void 0,r.dom.redrawNow()),u(r)}})}function f(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function d(e){e.onChange&&e.onChange(e.shapes)}r.start=function(e,t){if(!(t.touches&&1<t.touches.length)){t.stopPropagation(),t.preventDefault(),t.ctrlKey?s.unselect(e):s.cancelMove(e);var r,n,o,i=l.eventPosition(t),a=s.getKeyAtDomPos(i,"white"===e.orientation,e.dom.bounds());a&&(e.drawable.current={orig:a,pos:i,brush:(r=t,n=r.shiftKey&&l.isRightButton(r)?1:0,o=r.altKey?2:0,c[n+o])},u(e))}},r.processDraw=u,r.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=l.eventPosition(t))},r.end=function(e){var t=e.drawable.current;t&&(t.mouseSq&&(r=e.drawable,n=t,i=function(e){return e.orig===n.orig&&e.dest===n.dest},a=r.shapes.filter(i)[0],a&&(r.shapes=r.shapes.filter((o=i,function(e){return!o(e)}))),a&&a.brush===n.brush||r.shapes.push(n),d(r)),f(e));var r,n,o,i,a},r.cancel=f,r.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),d(e.drawable))}},{"./board":4,"./util":17}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("./drag"),s=e("./draw"),l=e("./util");function c(e,t,r,n){return e.addEventListener(t,r,n),function(){return e.removeEventListener(t,r)}}function u(t,r,n){return function(e){e.shiftKey||l.isRightButton(e)?t.drawable.enabled&&n(t,e):t.viewOnly||r(t,e)}}r.bindBoard=function(e){if(!e.viewOnly){var t,r=e.dom.elements.board,n=(t=e,function(e){t.draggable.current?a.cancel(t):t.drawable.current?s.cancel(t):e.shiftKey||l.isRightButton(e)?t.drawable.enabled&&s.start(t,e):t.viewOnly||a.start(t,e)});r.addEventListener("touchstart",n),r.addEventListener("mousedown",n),(e.disableContextMenu||e.drawable.enabled)&&r.addEventListener("contextmenu",function(e){return e.preventDefault()})}},r.bindDocument=function(e,t){var r=[];!e.dom.relative&&e.resizable&&r.push(c(document.body,"chessground.resize",function(){e.dom.bounds.clear(),l.raf(t)}));if(!e.viewOnly){var n=u(e,a.move,s.move),o=u(e,a.end,s.end);["touchmove","mousemove"].forEach(function(e){return r.push(c(document,e,n))}),["touchend","mouseup"].forEach(function(e){return r.push(c(document,e,o))});var i=function(){return e.dom.bounds.clear()};r.push(c(window,"scroll",i,{passive:!0})),r.push(c(window,"resize",i,{passive:!0}))}return function(){return r.forEach(function(e){return e()})}}},{"./drag":7,"./draw":8,"./util":17}],10:[function(e,t,r){"use strict";function n(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){n(e,2),setTimeout(function(){return n(e,void 0)},120)},120)}},{}],11:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var u=e("./util"),i=e("./types");c.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";var f={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},a={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};c.read=function(e){"start"===e&&(e=c.initial);for(var t={},r=8,n=0,o=0,i=e;o<i.length;o++){var a=i[o];switch(a){case" ":return t;case"/":if(0==--r)return t;n=0;break;case"~":t[u.pos2key([n,r])].promoted=!0;break;default:var s=a.charCodeAt(0);if(s<57)n+=s-48;else{++n;var l=a.toLowerCase();t[u.pos2key([n,r])]={role:f[l],color:a===l?"black":"white"}}}}return t},c.write=function(r){var n,o;return u.invRanks.map(function(t){return i.ranks.map(function(e){return(n=r[u.pos2key([e,t])])?(o=a[n.role],"white"===n.color?o.toUpperCase():o):"1"}).join("")}).join("/").replace(/1{2,}/g,function(e){return e.length.toString()})}},{"./types":16,"./util":17}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=e("./util");function v(e,t){return Math.abs(e-t)}var h=function(e,t,r,n){var o=v(e,r),i=v(t,n);return 1===o&&2===i||2===o&&1===i},m=function(e,t,r,n){return v(e,r)===v(t,n)},g=function(e,t,r,n){return e===r||t===n},b=function(e,t,r,n){return m(e,t,r,n)||g(e,t,r,n)};r.default=function(e,t,r){var n,o,i,a,s,l,c,u,f=e[t],d=p.key2pos(t);switch(f.role){case"pawn":u=f.color,n=function(e,t,r,n){return v(e,r)<2&&("white"===u?n===t+1||t<=2&&n===t+2&&e===r:n===t-1||7<=t&&n===t-2&&e===r)};break;case"knight":n=h;break;case"bishop":n=m;break;case"rook":n=g;break;case"queen":n=b;break;case"king":o=f.color,s=e,l=f.color,i=Object.keys(s).filter(function(e){return(c=s[e])&&c.color===l&&"rook"===c.role}).map(function(e){return p.key2pos(e)[0]}),a=r,n=function(e,t,r,n){return v(e,r)<2&&v(t,n)<2||a&&t===n&&t===("white"===o?1:8)&&(5===e&&(3===r||7===r)||p.containsX(i,r))}}return p.allKeys.map(p.key2pos).filter(function(e){return(d[0]!==e[0]||d[1]!==e[1])&&n(d[0],d[1],e[0],e[1])}).map(p.pos2key)}},{"./util":17}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var j=e("./util"),I=e("./util");function B(e,t){for(var r in t)e.dom.elements.board.removeChild(t[r])}function D(e,t){var r=2+8*(e[1]-1)+(8-e[0]);return t&&(r=67-r),r+""}function q(e){return e.color+" "+e.role}function Q(e,t,r){e[t]?e[t]+=" "+r:e[t]=r}r.default=function(e){var t,r,n,o,i,a,s,l,c,u,f,d="white"===e.orientation,p=e.dom.relative?I.posToTranslateRel:I.posToTranslateAbs(e.dom.bounds()),v=e.dom.relative?I.translateRel:I.translateAbs,h=e.dom.elements.board,m=e.pieces,g=e.animation.current,b=g?g.plan.anims:{},y=g?g.plan.fadings:{},w=e.draggable.current,k=function(e){var t,r,n={};if(e.lastMove&&e.highlight.lastMove)for(t in e.lastMove)Q(n,e.lastMove[t],"last-move");if(e.check&&e.highlight.check&&Q(n,e.check,"check"),e.selected&&(Q(n,e.selected,"selected"),e.movable.showDests)){var o=e.movable.dests&&e.movable.dests[e.selected];if(o)for(t in o)r=o[t],Q(n,r,"move-dest"+(e.pieces[r]?" oc":""));var i=e.premovable.dests;if(i)for(t in i)r=i[t],Q(n,r,"premove-dest"+(e.pieces[r]?" oc":""))}var a=e.premovable.current;if(a)for(t in a)Q(n,a[t],"current-premove");else e.predroppable.current&&Q(n,e.predroppable.current.key,"current-premove");var s=e.exploding;if(s)for(t in s.keys)Q(n,s.keys[t],"exploding"+s.stage);return n}(e),x={},P={},E={},C={},_=Object.keys(m);for(n=h.firstChild;n;){if(t=n.cgKey,"PIECE"===n.tagName)o=m[t],a=b[t],s=y[t],i=n.cgPiece,!n.cgDragging||w&&w.orig===t||(n.classList.remove("dragging"),v(n,p(j.key2pos(t),d)),n.cgDragging=!1),!s&&n.cgFading&&(n.cgFading=!1,n.classList.remove("fading")),o?(a&&n.cgAnimating&&i===q(o)?((R=j.key2pos(t))[0]+=a[2],R[1]+=a[3],n.classList.add("anim"),v(n,p(R,d))):n.cgAnimating&&(n.cgAnimating=!1,n.classList.remove("anim"),v(n,p(j.key2pos(t),d)),e.addPieceZIndex&&(n.style.zIndex=D(j.key2pos(t),d))),i!==q(o)||s&&n.cgFading?s&&i===q(s)?(n.classList.add("fading"),n.cgFading=!0):E[i]?E[i].push(n):E[i]=[n]:x[t]=!0):E[i]?E[i].push(n):E[i]=[n];else if("SQUARE"===n.tagName){var A=n.className;k[t]===A?P[t]=!0:C[A]?C[A].push(n):C[A]=[n]}n=n.nextSibling}for(var O in k)if(!P[O]){f=(u=C[k[O]])&&u.pop();var T=p(j.key2pos(O),d);if(f)f.cgKey=O,v(f,T);else{var N=j.createEl("square",k[O]);N.cgKey=O,v(N,T),h.insertBefore(N,h.firstChild)}}for(var S in _)if(r=m[t=_[S]],a=b[t],!x[t])if(c=(l=E[q(r)])&&l.pop()){c.cgKey=t,c.cgFading&&(c.classList.remove("fading"),c.cgFading=!1);var R=j.key2pos(t);e.addPieceZIndex&&(c.style.zIndex=D(R,d)),a&&(c.cgAnimating=!0,c.classList.add("anim"),R[0]+=a[2],R[1]+=a[3]),v(c,p(R,d))}else{var K=q(r),M=j.createEl("piece",K);R=j.key2pos(t),M.cgPiece=K,M.cgKey=t,a&&(M.cgAnimating=!0,R[0]+=a[2],R[1]+=a[3]),v(M,p(R,d)),e.addPieceZIndex&&(M.style.zIndex=D(R,d)),h.appendChild(M)}for(var L in E)B(e,E[L]);for(var L in C)B(e,C[L])}},{"./util":17}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./fen"),o=e("./util");r.defaults=function(){return{pieces:n.read(n.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"},prevSvgHash:""},hold:o.timer()}}},{"./fen":11,"./util":17}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var $,F=e("./util");function W(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function c(e,t,r){var n,o,i=e.orig,a=e.dest,s=e.brush,l=e.piece,c=e.modifiers;return[r,i,a,s,a&&1<t[a],l&&(o=l,[o.color,o.role,o.scale].filter(function(e){return e}).join("")),c&&(n=c,""+(n.lineWidth||""))].filter(function(e){return e}).join("")}function u(e){var t=G(W("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(G(W("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function G(e,t){for(var r in t)e.setAttribute(r,t[r]);return e}function H(e,t){return"white"===t?e:[9-e[0],9-e[1]]}function X(e,t){var r={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return r.key=[e.key,t.lineWidth].filter(function(e){return e}).join(""),r}function Z(e,t){return(e.opacity||1)*(t?.9:1)}function V(e,t){return[(e[0]-.5)*t.width/8,(8.5-e[1])*t.height/8]}r.createElement=W,r.renderSvg=function(e,t){var r=e.drawable,n=r.current,o=n&&n.mouseSq?n:void 0,i={};r.shapes.concat(r.autoShapes).concat(o?[o]:[]).forEach(function(e){e.dest&&(i[e.dest]=(i[e.dest]||0)+1)});var a=r.shapes.concat(r.autoShapes).map(function(e){return{shape:e,current:!1,hash:c(e,i,!1)}});o&&a.push({shape:o,current:!0,hash:c(o,i,!0)});var s=a.map(function(e){return e.hash}).join("");if(s!==e.drawable.prevSvgHash){e.drawable.prevSvgHash=s;var l=t.firstChild;!function(t,e,r){var n,o={};e.forEach(function(e){e.shape.dest&&(n=t.brushes[e.shape.brush],e.shape.modifiers&&(n=X(n,e.shape.modifiers)),o[n.key]=n)});for(var i={},a=r.firstChild;a;)i[a.getAttribute("cgKey")]=!0,a=a.nextSibling;for(var s in o)i[s]||r.appendChild(u(o[s]))}(r,a,l),function(t,e,r,n,o,i){void 0===$&&($=F.computeIsTrident());var a=t.dom.bounds(),s={},l=[];e.forEach(function(e){s[e.hash]=!1});for(var c,u=i.nextSibling;u;)c=u.getAttribute("cgHash"),s.hasOwnProperty(c)?s[c]=!0:l.push(u),u=u.nextSibling;l.forEach(function(e){return o.removeChild(e)}),e.forEach(function(e){s[e.hash]||o.appendChild(function(e,t,r,n,o){var i,a,s,l,c,u,f,d,p,v,h,m,g,b,y,w,k,x,P,E,C,_,A,O,T,N,S,R,K,M,L,j,I,B,D=t.shape,q=t.current,Q=t.hash;if(D.piece)R=e.drawable.pieces.baseUrl,K=H(F.key2pos(D.orig),e.orientation),M=D.piece,j=V(K,L=o),I=L.width/8*(M.scale||1),B=M.color[0]+("knight"===M.role?"n":M.role[0]).toUpperCase(),i=G(W("image"),{className:M.role+" "+M.color,x:j[0]-I/2,y:j[1]-I/2,width:I,height:I,href:R+B+".svg"});else{var U=H(F.key2pos(D.orig),e.orientation);if(D.orig&&D.dest){var z=r[D.brush];D.modifiers&&(z=X(z,D.modifiers)),p=z,v=U,h=H(F.key2pos(D.dest),e.orientation),m=q,g=1<n[D.dest],A=b=o,O=g&&!m,y=$?0:(O?20:10)/512*A.width,w=V(v,b),k=V(h,b),x=k[0]-w[0],P=k[1]-w[1],E=Math.atan2(P,x),C=Math.cos(E)*y,_=Math.sin(E)*y,i=G(W("line"),{stroke:p.color,"stroke-width":(T=p,N=m,S=b,(T.lineWidth||10)*(N?.85:1)/512*S.width),"stroke-linecap":"round","marker-end":$?void 0:"url(#arrowhead-"+p.key+")",opacity:Z(p,m),x1:w[0],y1:w[1],x2:k[0]-C,y2:k[1]-_})}else a=r[D.brush],s=q,c=V(U,l=o),d=l.width/512,u=[3*d,4*d],f=(l.width+l.height)/32,i=G(W("circle"),{stroke:a.color,"stroke-width":u[s?0:1],fill:"none",opacity:Z(a,s),cx:c[0],cy:c[1],r:f-u[1]/2})}return i.setAttribute("cgHash",Q),i}(t,e,r,n,a))})}(e,a,r.brushes,i,t,l)}}},{"./util":17}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.files=["a","b","c","d","e","f","g","h"],r.ranks=[1,2,3,4,5,6,7,8]},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./types");r.colors=["white","black"],r.invRanks=[8,7,6,5,4,3,2,1],r.allKeys=(o=Array.prototype).concat.apply(o,n.files.map(function(t){return n.ranks.map(function(e){return t+e})})),r.pos2key=function(e){return r.allKeys[8*e[0]+e[1]-9]},r.key2pos=function(e){return[e.charCodeAt(0)-96,e.charCodeAt(1)-48]},r.memo=function(e){var t,r=function(){return void 0===t&&(t=e()),t};return r.clear=function(){t=void 0},r},r.timer=function(){var t;return{start:function(){t=Date.now()},cancel:function(){t=void 0},stop:function(){if(!t)return 0;var e=Date.now()-t;return t=void 0,e}}},r.opposite=function(e){return"white"===e?"black":"white"},r.containsX=function(e,t){return void 0!==e&&-1!==e.indexOf(t)},r.distanceSq=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},r.samePiece=function(e,t){return e.role===t.role&&e.color===t.color},r.computeIsTrident=function(){return-1<window.navigator.userAgent.indexOf("Trident/")};var o,i=function(e,t,r,n){return[(t?e[0]-1:8-e[0])*r,(t?8-e[1]:e[1]-1)*n]};r.posToTranslateAbs=function(e){var r=e.width/8,n=e.height/8;return function(e,t){return i(e,t,r,n)}},r.posToTranslateRel=function(e,t){return i(e,t,12.5,12.5)},r.translateAbs=function(e,t){e.style.transform="translate("+t[0]+"px,"+t[1]+"px)"},r.translateRel=function(e,t){e.style.left=t[0]+"%",e.style.top=t[1]+"%"},r.setVisible=function(e,t){e.style.visibility=t?"visible":"hidden"},r.eventPosition=function(e){return e.clientX||0===e.clientX?[e.clientX,e.clientY]:e.touches&&e.targetTouches[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0},r.isRightButton=function(e){return 2===e.buttons||2===e.button},r.createEl=function(e,t){var r=document.createElement(e);return t&&(r.className=t),r},r.raf=(window.requestAnimationFrame||window.setTimeout).bind(window)},{"./types":16}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("./util"),l=e("./types"),c=e("./svg");function u(e,t){var r,n=s.createEl("coords",t);for(var o in e)(r=s.createEl("coord")).textContent=e[o],n.appendChild(r);return n}r.default=function(t,r,e){t.innerHTML="",t.classList.add("cg-board-wrap"),s.colors.forEach(function(e){t.classList.toggle("orientation-"+e,r.orientation===e)}),t.classList.toggle("manipulable",!r.viewOnly);var n,o,i=s.createEl("div","cg-board");if(t.appendChild(i),r.drawable.visible&&e&&((n=c.createElement("svg")).appendChild(c.createElement("defs")),t.appendChild(n)),r.coordinates){var a="black"===r.orientation?" black":"";t.appendChild(u(l.ranks,"ranks"+a)),t.appendChild(u(l.files,"files"+a))}return e&&r.draggable.showGhost&&(o=s.createEl("piece","ghost"),s.setVisible(o,!1),t.appendChild(o)),{board:i,ghost:o,svg:n}}},{"./svg":15,"./types":16,"./util":17}],19:[function(e,t,r){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],20:[function(t,b,e){(function(a){"use strict";var r=t("path-to-regexp");b.exports=f;var n,e,o="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",s="undefined"!=typeof window&&(window.history.location||window.location),i=!0,l=!0,c="",u=!1;function f(e,t){if("function"==typeof e)return f("*",e);if("function"==typeof t)for(var r=new v(e),n=1;n<arguments.length;++n)f.callbacks.push(r.middleware(arguments[n]));else"string"==typeof e?f["string"==typeof t?"redirect":"show"](e,t):f.start(e)}function d(e){return"string"!=typeof e?e:l?decodeURIComponent(e.replace(/\+/g," ")):e}function p(e,t){"/"===e[0]&&0!==e.indexOf(c)&&(e=c+(u?"#!":"")+e);var r=e.indexOf("?");if(this.canonicalPath=e,this.path=e.replace(c,"")||"/",u&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=t||{},this.state.path=e,this.querystring=~r?d(e.slice(r+1)):"",this.pathname=d(~r?e.slice(0,r):e),this.params={},this.hash="",!u){if(!~this.path.indexOf("#"))return;var n=this.path.split("#");this.path=n[0],this.hash=d(n[1])||"",this.querystring=this.querystring.split("#")[0]}}function v(e,t){t=t||{},this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=r(this.path,this.keys=[],t)}f.callbacks=[],f.exits=[],f.current="",f.len=0,f.base=function(e){if(0===arguments.length)return c;c=e},f.start=function(e){if(e=e||{},!n&&(!(n=!0)===e.dispatch&&(i=!1),!1===e.decodeURLComponents&&(l=!1),!1!==e.popstate&&window.addEventListener("popstate",h,!1),!1!==e.click&&document.addEventListener(o,m,!1),!0===e.hashbang&&(u=!0),i)){var t=u&&~s.hash.indexOf("#!")?s.hash.substr(2)+s.search:s.pathname+s.search+s.hash;f.replace(t,null,!0,i)}},f.stop=function(){n&&(f.current="",f.len=0,n=!1,document.removeEventListener(o,m,!1),window.removeEventListener("popstate",h,!1))},f.show=function(e,t,r,n){var o=new p(e,t);return f.current=o.path,!1!==r&&f.dispatch(o),!1!==o.handled&&!1!==n&&o.pushState(),o},f.back=function(e,t){0<f.len?(history.back(),f.len--):e?setTimeout(function(){f.show(e,t)}):setTimeout(function(){f.show(c,t)})},f.redirect=function(e,t){"string"==typeof e&&"string"==typeof t&&f(e,function(e){setTimeout(function(){f.replace(t)},0)}),"string"==typeof e&&void 0===t&&setTimeout(function(){f.replace(e)},0)},f.replace=function(e,t,r,n){var o=new p(e,t);return f.current=o.path,o.init=r,o.save(),!1!==n&&f.dispatch(o),o},f.dispatch=function(t){var r=e,n=0,o=0;function i(){var e=f.callbacks[n++];if(t.path===f.current)return e?void e(t,i):function(e){if(e.handled)return;var t;t=u?c+s.hash.replace("#!",""):s.pathname+s.search;if(t===e.canonicalPath)return;f.stop(),e.handled=!1,s.href=e.canonicalPath}(t);t.handled=!1}e=t,r?function e(){var t=f.exits[o++];if(!t)return i();t(r,e)}():i()},f.exit=function(e,t){if("function"==typeof e)return f.exit("*",e);for(var r=new v(e),n=1;n<arguments.length;++n)f.exits.push(r.middleware(arguments[n]))},(f.Context=p).prototype.pushState=function(){f.len++,history.pushState(this.state,this.title,u&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},p.prototype.save=function(){history.replaceState(this.state,this.title,u&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},(f.Route=v).prototype.middleware=function(r){var n=this;return function(e,t){if(n.match(e.path,e.params))return r(e,t);t()}},v.prototype.match=function(e,t){var r=this.keys,n=e.indexOf("?"),o=~n?e.slice(0,n):e,i=this.regexp.exec(decodeURIComponent(o));if(!i)return!1;for(var a=1,s=i.length;a<s;++a){var l=r[a-1],c=d(i[a]);void 0===c&&hasOwnProperty.call(t,l.name)||(t[l.name]=c)}return!0};var h=function(){var r=!1;if("undefined"!=typeof window)return"complete"===document.readyState?r=!0:window.addEventListener("load",function(){setTimeout(function(){r=!0},0)}),function(e){if(r)if(e.state){var t=e.state.path;f.replace(t,e.state)}else f.show(s.pathname+s.hash,void 0,void 0,!1)}}();function m(e){var t;if(1===(null===(t=(t=e)||window.event).which?t.button:t.which)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var r=e.path?e.path[0]:e.target;r&&"A"!==r.nodeName;)r=r.parentNode;if(r&&"A"===r.nodeName&&!r.hasAttribute("download")&&"external"!==r.getAttribute("rel")){var n=r.getAttribute("href");if((u||r.pathname!==s.pathname||!r.hash&&"#"!==n)&&!(n&&-1<n.indexOf("mailto:"))&&!r.target&&g(r.href)){var o=r.pathname+r.search+(r.hash||"");void 0!==a&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var i=o;0===o.indexOf(c)&&(o=o.substr(c.length)),u&&(o=o.replace("#!","")),c&&i===o||(e.preventDefault(),f.show(i))}}}}function g(e){var t=s.protocol+"//"+s.hostname;return s.port&&(t+=":"+s.port),e&&0===e.indexOf(t)}f.sameOrigin=g}).call(this,t("_process"))},{_process:22,"path-to-regexp":21}],21:[function(e,t,r){var u=e("isarray");t.exports=i,t.exports.parse=a,t.exports.compile=function(e){return n(a(e))},t.exports.tokensToFunction=n,t.exports.tokensToRegExp=l;var w=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function a(e){for(var t,r,n=[],o=0,i=0,a="";null!=(t=w.exec(e));){var s=t[0],l=t[1],c=t.index;if(a+=e.slice(i,c),i=c+s.length,l)a+=l[1];else{a&&(n.push(a),a="");var u=t[2],f=t[3],d=t[4],p=t[5],v=t[6],h=t[7],m="+"===v||"*"===v,g="?"===v||"*"===v,b=u||"/",y=d||p||(h?".*":"[^"+b+"]+?");n.push({name:f||o++,prefix:u||"",delimiter:b,optional:g,repeat:m,pattern:(r=y,r.replace(/([=!:$\/()])/g,"\\$1"))})}}return i<e.length&&(a+=e.substr(i)),a&&n.push(a),n}function n(l){for(var c=new Array(l.length),e=0;e<l.length;e++)"object"==typeof l[e]&&(c[e]=new RegExp("^"+l[e].pattern+"$"));return function(e){for(var t="",r=e||{},n=0;n<l.length;n++){var o=l[n];if("string"!=typeof o){var i,a=r[o.name];if(null==a){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to be defined')}if(u(a)){if(!o.repeat)throw new TypeError('Expected "'+o.name+'" to not repeat, but received "'+a+'"');if(0===a.length){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to not be empty')}for(var s=0;s<a.length;s++){if(i=encodeURIComponent(a[s]),!c[n].test(i))throw new TypeError('Expected all "'+o.name+'" to match "'+o.pattern+'", but received "'+i+'"');t+=(0===s?o.prefix:o.delimiter)+i}}else{if(i=encodeURIComponent(a),!c[n].test(i))throw new TypeError('Expected "'+o.name+'" to match "'+o.pattern+'", but received "'+i+'"');t+=o.prefix+i}}else t+=o}return t}}function f(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function s(e,t){return e.keys=t,e}function d(e){return e.sensitive?"":"i"}function l(e,t){for(var r=(t=t||{}).strict,n=!1!==t.end,o="",i=e[e.length-1],a="string"==typeof i&&/\/$/.test(i),s=0;s<e.length;s++){var l=e[s];if("string"==typeof l)o+=f(l);else{var c=f(l.prefix),u=l.pattern;l.repeat&&(u+="(?:"+c+u+")*"),o+=u=l.optional?c?"(?:"+c+"("+u+"))?":"("+u+")?":c+"("+u+")"}}return r||(o=(a?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=n?"$":r&&a?"":"(?=\\/|$)",new RegExp("^"+o,d(t))}function i(e,t,r){return u(t=t||[])?r||(r={}):(r=t,t=[]),e instanceof RegExp?function(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return s(e,t)}(e,t):u(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(i(e[o],t,r).source);return s(new RegExp("(?:"+n.join("|")+")",d(r)),t)}(e,t,r):function(e,t,r){for(var n=a(e),o=l(n,r),i=0;i<n.length;i++)"string"!=typeof n[i]&&t.push(n[i]);return s(o,t)}(e,t,r)}},{isarray:19}],22:[function(e,t,r){var n,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var c,u=[],f=!1,d=-1;function p(){f&&c&&(f=!1,c.length?u=c.concat(u):d=-1,u.length&&v())}function v(){if(!f){var e=l(p);f=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||f||l(v)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("./vnode"),l=e("./is");function n(e,t,r){var n,o,i,a={};if(void 0!==r?(a=t,l.array(r)?n=r:l.primitive(r)?o=r:r&&r.sel&&(n=[r])):void 0!==t&&(l.array(t)?n=t:l.primitive(t)?o=t:t&&t.sel?n=[t]:a=t),l.array(n))for(i=0;i<n.length;++i)l.primitive(n[i])&&(n[i]=s.vnode(void 0,void 0,void 0,n[i]));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,r,n){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==r)for(var o=0;o<r.length;++o){var i=r[o].data;void 0!==i&&e(i,r[o].children,r[o].sel)}}(a,n,e),s.vnode(e,a,n,o,void 0)}r.h=n,r.default=n},{"./is":25,"./vnode":31}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.htmlDomApi={createElement:function(e){return document.createElement(e)},createElementNS:function(e,t){return document.createElementNS(e,t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,r){e.insertBefore(t,r)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},getTextContent:function(e){return e.textContent},isElement:function(e){return 1===e.nodeType},isText:function(e){return 3===e.nodeType},isComment:function(e){return 8===e.nodeType}},r.default=r.htmlDomApi},{}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.array=Array.isArray,r.primitive=function(e){return"string"==typeof e||"number"==typeof e}},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});for(var n=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],s=Object.create(null),o=0,i=n.length;o<i;o++)s[n[o]]=!0;function a(e,t){var r,n=t.elm,o=e.data.attrs,i=t.data.attrs;if((o||i)&&o!==i){for(r in o=o||{},i=i||{}){var a=i[r];o[r]!==a&&(s[r]?a?n.setAttribute(r,""):n.removeAttribute(r):120!==r.charCodeAt(0)?n.setAttribute(r,a):58===r.charCodeAt(3)?n.setAttributeNS("http://www.w3.org/XML/1998/namespace",r,a):58===r.charCodeAt(5)?n.setAttributeNS("http://www.w3.org/1999/xlink",r,a):n.setAttribute(r,a))}for(r in o)r in i||n.removeAttribute(r)}}r.attributesModule={create:a,update:a},r.default=r.attributesModule},{}],27:[function(e,t,r){"use strict";function n(e,t){var r,n,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){for(n in a=a||{},i=i||{})a[n]||o.classList.remove(n);for(n in a)(r=a[n])!==i[n]&&o.classList[r?"add":"remove"](n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.classModule={create:n,update:n},r.default=r.classModule},{}],28:[function(e,t,r){"use strict";function c(e,t){var r=e.type,n=t.data.on;n&&n[r]&&function e(t,r,n){if("function"==typeof t)t.call(r,n,r);else if("object"==typeof t)if("function"==typeof t[0])if(2===t.length)t[0].call(r,t[1],n,r);else{var o=t.slice(1);o.push(n),o.push(r),t[0].apply(r,o)}else for(var i=0;i<t.length;i++)e(t[i])}(n[r],t,e)}function n(e,t){var r,n=e.data.on,o=e.listener,i=e.elm,a=t&&t.data.on,s=t&&t.elm;if(n!==a){if(n&&o)if(a)for(r in n)a[r]||i.removeEventListener(r,o,!1);else for(r in n)i.removeEventListener(r,o,!1);if(a){var l=t.listener=e.listener||function e(t){c(t,e.vnode)};if(l.vnode=t,n)for(r in a)n[r]||s.addEventListener(r,l,!1);else for(r in a)s.addEventListener(r,l,!1)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.eventListenersModule={create:n,update:n,destroy:n},r.default=r.eventListenersModule},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=e("./vnode"),v=e("./is"),i=e("./htmldomapi");function w(e){return void 0===e}function k(e){return void 0!==e}var x=u.default("",{},[],void 0,void 0);function P(e,t){return e.key===t.key&&e.sel===t.sel}function E(e,t,r){var n,o,i,a={};for(n=t;n<=r;++n)null!=(i=e[n])&&void 0!==(o=i.key)&&(a[o]=n);return a}var a=["create","update","remove","destroy","pre","post"],n=e("./h");r.h=n.h;var o=e("./thunk");r.thunk=o.thunk,r.init=function(e,t){var r,n,p={},h=void 0!==t?t:i.default;for(r=0;r<a.length;++r)for(p[a[r]]=[],n=0;n<e.length;++n){var o=e[n][a[r]];void 0!==o&&p[a[r]].push(o)}function l(t,r){return function(){if(0==--r){var e=h.parentNode(t);h.removeChild(e,t)}}}function m(e,t){var r,n=e.data;void 0!==n&&k(r=n.hook)&&k(r=r.init)&&(r(e),n=e.data);var o=e.children,i=e.sel;if("!"===i)w(e.text)&&(e.text=""),e.elm=h.createComment(e.text);else if(void 0!==i){var a=i.indexOf("#"),s=i.indexOf(".",a),l=0<a?a:i.length,c=0<s?s:i.length,u=-1!==a||-1!==s?i.slice(0,Math.min(l,c)):i,f=e.elm=k(n)&&k(r=n.ns)?h.createElementNS(r,u):h.createElement(u);for(l<c&&f.setAttribute("id",i.slice(l+1,c)),0<s&&f.setAttribute("class",i.slice(c+1).replace(/\./g," ")),r=0;r<p.create.length;++r)p.create[r](x,e);if(v.array(o))for(r=0;r<o.length;++r){var d=o[r];null!=d&&h.appendChild(f,m(d,t))}else v.primitive(e.text)&&h.appendChild(f,h.createTextNode(e.text));k(r=e.data.hook)&&(r.create&&r.create(x,e),r.insert&&t.push(e))}else e.elm=h.createTextNode(e.text);return e.elm}function g(e,t,r,n,o,i){for(;n<=o;++n){var a=r[n];null!=a&&h.insertBefore(e,m(a,i),t)}}function c(e){var t,r,n=e.data;if(void 0!==n){for(k(t=n.hook)&&k(t=t.destroy)&&t(e),t=0;t<p.destroy.length;++t)p.destroy[t](e);if(void 0!==e.children)for(r=0;r<e.children.length;++r)null!=(t=e.children[r])&&"string"!=typeof t&&c(t)}}function b(e,t,r,n){for(;r<=n;++r){var o=void 0,i=void 0,a=void 0,s=t[r];if(null!=s)if(k(s.sel)){for(c(s),i=p.remove.length+1,a=l(s.elm,i),o=0;o<p.remove.length;++o)p.remove[o](s,a);k(o=s.data)&&k(o=o.hook)&&k(o=o.remove)?o(s,a):a()}else h.removeChild(e,s.elm)}}function y(e,t,r){var n,o;k(n=t.data)&&k(o=n.hook)&&k(n=o.prepatch)&&n(e,t);var i=t.elm=e.elm,a=e.children,s=t.children;if(e!==t){if(void 0!==t.data){for(n=0;n<p.update.length;++n)p.update[n](e,t);k(n=t.data.hook)&&k(n=n.update)&&n(e,t)}w(t.text)?k(a)&&k(s)?a!==s&&function(e,t,r,n){for(var o,i,a,s=0,l=0,c=t.length-1,u=t[0],f=t[c],d=r.length-1,p=r[0],v=r[d];s<=c&&l<=d;)null==u?u=t[++s]:null==f?f=t[--c]:null==p?p=r[++l]:null==v?v=r[--d]:P(u,p)?(y(u,p,n),u=t[++s],p=r[++l]):P(f,v)?(y(f,v,n),f=t[--c],v=r[--d]):P(u,v)?(y(u,v,n),h.insertBefore(e,u.elm,h.nextSibling(f.elm)),u=t[++s],v=r[--d]):(P(f,p)?(y(f,p,n),h.insertBefore(e,f.elm,u.elm),f=t[--c]):(void 0===o&&(o=E(t,s,c)),w(i=o[p.key])?h.insertBefore(e,m(p,n),u.elm):(a=t[i]).sel!==p.sel?h.insertBefore(e,m(p,n),u.elm):(y(a,p,n),t[i]=void 0,h.insertBefore(e,a.elm,u.elm))),p=r[++l]);c<s?g(e,null==r[d+1]?null:r[d+1].elm,r,l,d,n):d<l&&b(e,t,s,c)}(i,a,s,r):k(s)?(k(e.text)&&h.setTextContent(i,""),g(i,null,s,0,s.length-1,r)):k(a)?b(i,a,0,a.length-1):k(e.text)&&h.setTextContent(i,""):e.text!==t.text&&h.setTextContent(i,t.text),k(o)&&k(n=o.postpatch)&&n(e,t)}}return function(e,t){var r,n,o,i,a,s,l=[];for(r=0;r<p.pre.length;++r)p.pre[r]();for(void 0===e.sel&&(a=(i=e).id?"#"+i.id:"",s=i.className?"."+i.className.split(" ").join("."):"",e=u.default(h.tagName(i).toLowerCase()+a+s,{},[],void 0,i)),P(e,t)?y(e,t,l):(n=e.elm,o=h.parentNode(n),m(t,l),null!==o&&(h.insertBefore(o,t.elm,h.nextSibling(n)),b(o,[e],0,0))),r=0;r<l.length;++r)l[r].data.hook.insert(l[r]);for(r=0;r<p.post.length;++r)p.post[r]();return t}}},{"./h":23,"./htmldomapi":24,"./is":25,"./thunk":30,"./vnode":31}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./h");function s(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function i(e){var t=e.data;s(t.fn.apply(void 0,t.args),e)}function a(e,t){var r,n=e.data,o=t.data,i=n.args,a=o.args;if(n.fn===o.fn&&i.length===a.length){for(r=0;r<a.length;++r)if(i[r]!==a[r])return void s(o.fn.apply(void 0,a),t);s(e,t)}else s(o.fn.apply(void 0,a),t)}r.thunk=function(e,t,r,n){return void 0===n&&(n=r,r=t,t=void 0),o.h(e,{key:t,hook:{init:i,prepatch:a},fn:r,args:n})},r.default=r.thunk},{"./h":23}],31:[function(e,t,r){"use strict";function n(e,t,r,n,o){return{sel:e,data:t,children:r,text:n,elm:o,key:void 0===t?void 0:t.key}}Object.defineProperty(r,"__esModule",{value:!0}),r.vnode=n,r.default=n},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("snabbdom"),a=e("snabbdom/modules/class"),s=e("snabbdom/modules/attributes"),l=e("snabbdom/modules/eventlisteners"),c=e("page"),u=e("./units/analysis");r.run=function(t){var r,n=i.init([a.default,s.default,l.default]);function e(){var e;r=n(r||t,(e=o.map(function(e){return i.h("section.blue.merida",[i.h("div.cg-board-wrap",{hook:{insert:e.runUnit,postpatch:e.runUnit}}),i.h("p","Puzzle")])}),i.h("div#chessground-examples",e)))}var o=new u.Analysis({}).puzzles("tailuge");c({click:!1,popstate:!1,dispatch:!1,hashbang:!0}),c("/:id",function(){e()}),c(location.hash.slice(2)||"/0")}},{"./units/analysis":33,page:20,snabbdom:29,"snabbdom/modules/attributes":26,"snabbdom/modules/class":27,"snabbdom/modules/eventlisteners":28}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("chess.js"),n=e("./puzzle"),o=function(){function e(e){this.gameAnalysis=e,this.gameAnalysis=this.example()[0]}return e.prototype.puzzles=function(e){var r=this,t=new i.Chess,n=[];this.gameAnalysis.moves.split(" ").forEach(function(e){n.push(t.fen()),t.move(e)}),t.history({verbose:!0}).forEach(function(e,t){r.gameAnalysis.analysis[t].move=e,r.gameAnalysis.analysis[t].halfMove=t+1,r.gameAnalysis.analysis[t].fen=n[t]});var o=this.gameAnalysis.players.white.user.id==e?"w":"b";return this.gameAnalysis.analysis=this.gameAnalysis.analysis.filter(function(e){return e.judgment}).filter(function(e){return e.move.color==o}),console.log(this.gameAnalysis.analysis),this.gameAnalysis.analysis.map(function(e){return r.toPuzzle(e)})},e.prototype.toPuzzle=function(e){return new n.Puzzle(e.fen,e.move,{from:e.best.substring(0,2),to:e.best.substring(2,4)})},e.prototype.example=function(){return[{id:"LU6oDId7",rated:!1,variant:"standard",players:{white:{user:{id:"copperhead",name:"Copperhead"},rating:1614,analysis:{inaccuracy:4,mistake:1,blunder:1,acpl:37}},black:{user:{id:"tailuge",name:"tailuge"},rating:1611,analysis:{inaccuracy:5,mistake:3,blunder:1,acpl:54}}},winner:"white",opening:{eco:"D10",name:"Slav Defense #2",ply:5},moves:"d4 c6 c4 d5 Nc3 Bf5 Bf4 e6 e3 Bd6 Bg3 Bxg3 hxg3 Nf6 Be2 Ne4 Nf3 Nxc3 bxc3 Nd7 cxd5 exd5 Nh4 Be6 Bd3 Nf6 Qc2 Qa5 Ke2 Ne4 Rhc1 O-O-O Bxe4 dxe4 Qxe4 Bc4+ Kd2 g6 Nf3 f5 Qc2 Bd5 Rcb1 Be4 Qb3 Bxb1 Rxb1 b6 Qe6+ Kb8 Qe5+ Qxe5 Nxe5 c5 Nc6+ Kc7 Nxd8 Rxd8 a4 cxd4 cxd4 Rd5 Rb5 Rxb5 axb5 a6 bxa6 Kb8 Kc3",analysis:[{eval:8},{eval:21},{eval:15},{eval:47},{eval:2},{eval:90,best:"g8f6",variation:"Nf6 cxd5 cxd5 Nf3 Nc6 Bf4 Nh5 Bd2 Nf6 e3",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Nf6."}},{eval:28,best:"d1b3",variation:"Qb3 Qb6 Qxb6 axb6 cxd5 Nf6 dxc6 Nxc6 e3 Nb4",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Qb3."}},{eval:25},{eval:12},{eval:38},{eval:10},{eval:25},{eval:24},{eval:23},{eval:4},{eval:54,best:"d8b6",variation:"Qb6 b3 Qb4 Qd2 O-O f3 h6 g4 Bg6 Nh3 dxc4 bxc4 Nbd7 Kf1",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Qb6."}},{eval:20},{eval:23},{eval:20},{eval:55},{eval:35},{eval:41},{eval:32},{eval:42},{eval:0},{eval:52,best:"g7g6",variation:"g6 Nf3 O-O Kf1 Re8 Rh4 b6 g4 Nf6 Ne5 Nd7 Nf3",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was g6."}},{eval:15},{eval:50},{eval:0,best:"e1g1",variation:"O-O",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was O-O."}},{eval:10},{eval:-6},{eval:96,best:"e4d6",variation:"Nd6 Nf3 Rc8 a4 g6 Nd2 O-O Kf1 Qd8 c4 c5 cxd5 cxd4 Qb2",judgment:{name:"Mistake",comment:"Mistake. Best move was Nd6."}},{eval:50},{eval:41},{eval:54},{eval:53},{eval:-15,best:"e2e1",variation:"Ke1 Kb8 Nf5 Rhg8 f3 Ka8 Kf2 g6 Nh6 Rge8 Qf4 f5 Kg1 a6",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Ke1."}},{eval:0},{eval:-35},{eval:55,best:"h8e8",variation:"Rhe8",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Rhe8."}},{eval:31},{eval:71},{eval:-48,best:"d2e1",variation:"Ke1 c5 Kf1 Qa6+ Kg1 Bxf3 gxf3 h5 Kg2 h4 Rh1 hxg3 fxg3 Qe6",judgment:{name:"Mistake",comment:"Mistake. Best move was Ke1."}},{eval:-36},{eval:-45},{eval:-35},{eval:-46},{eval:20,best:"d8d7",variation:"Rd7 a4 Re8 Ke1 Rc7 Kf1 c5 c4 cxd4 exd4 Qb6 Qc2 Qc6 Ne5",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Rd7."}},{eval:-43,best:"d2e2",variation:"Ke2 Rhe8 Kf1 Kb8 a4 Kb7 Kg1 Ka8 Rc1 Qa6 Ne5 Qb7 Rb1 Rb8",judgment:{name:"Inaccuracy",comment:"Inaccuracy. Best move was Ke2."}},{eval:-46},{eval:-48},{eval:-43},{eval:-43},{eval:176,best:"d8c8",variation:"Rc8 Rh1 Kc7 a4 Rce8 c4 Re6 a5 bxa5 Ra1 Ra8 Rxa5 Kb6 Ra1",judgment:{name:"Mistake",comment:"Mistake. Best move was Rc8."}},{eval:169},{eval:174},{eval:177},{eval:176},{eval:161},{eval:177},{eval:145},{eval:153},{eval:148},{eval:314,best:"d5d8",variation:"Rd8 Rb1 Kd6 f3 Rd7 Kd3 Rf7 a5 bxa5 Rb5 Kc6 Rxa5 Kb6 Ra1",judgment:{name:"Mistake",comment:"Mistake. Best move was Rd8."}},{eval:268},{eval:1391,best:"c7d6",variation:"Kd6 Kc3",judgment:{name:"Blunder",comment:"Blunder. Best move was Kd6."}},{eval:1367},{eval:1322},{eval:557,best:"d4d5",variation:"d5 g5 d6 f4 exf4 gxf4 gxf4 h5 a7+ Kxa7 d7 Kb7 d8=Q h4",judgment:{name:"Blunder",comment:"Blunder. Best move was d5."}}],clock:{initial:300,increment:0,totalTime:300}}]},e}();r.Analysis=o},{"./puzzle":34,"chess.js":1}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("chess.js"),s=e("chessground"),l=e("../util"),n=function(){function e(e,t,r){var n=this;this.runUnit=function(e){var t=e.elm;t.className="cg-board-wrap",n.run(t)},this.initialFen=e,this.movePlayed=t,this.bestMove=r}return e.prototype.run=function(e){var r=this,n=new a.Chess(this.initialFen),t=l.toColor(n),o={orientation:t,turnColor:t,fen:this.initialFen,movable:{color:t,free:!1,dests:l.toDests(n)}},i=s.Chessground(e,o);return i.set({movable:{events:{after:function(e,t){n.move({from:e,to:t}),i.set({turnColor:l.toColor(n),movable:{color:l.toColor(n),dests:l.toDests(n)},drawable:{shapes:[{orig:r.movePlayed.from,dest:r.movePlayed.to,brush:"red"},{orig:r.bestMove.from,dest:r.bestMove.to,brush:"green"}]}})}}},drawable:{shapes:[{orig:this.movePlayed.from,dest:this.movePlayed.to,brush:"red"}]},events:{select:function(e){i.set({drawable:{shapes:[{orig:r.movePlayed.from,dest:r.movePlayed.to,brush:"red"},{orig:e,brush:"blue"}]}})}}}),i},e}();r.Puzzle=n},{"../util":35,"chess.js":1,chessground:5}],35:[function(e,t,r){"use strict";function o(r){var n={};return r.SQUARES.forEach(function(e){var t=r.moves({square:e,verbose:!0});t.length&&(n[e]=t.map(function(e){return e.to}))}),n}function i(e){return"w"===e.turn()?"white":"black"}Object.defineProperty(r,"__esModule",{value:!0}),r.toDests=o,r.toColor=i,r.playOtherSide=function(r,n){return function(e,t){n.move({from:e,to:t}),r.set({turnColor:i(n),movable:{color:i(n),dests:o(n)}})}}},{}]},{},[32])(32)});